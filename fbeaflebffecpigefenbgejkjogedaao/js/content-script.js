(()=>{"use strict";var e,t,n,s={2171:(e,t,n)=>{n.d(t,{$M:()=>w,$p:()=>d,Ay:()=>T,F5:()=>p,Im:()=>x,L2:()=>b,OM:()=>m,PZ:()=>c,Re:()=>g,Sv:()=>k,Um:()=>u,VB:()=>C,fK:()=>S,lU:()=>y,nf:()=>h,q6:()=>l,tt:()=>f,vF:()=>a,wF:()=>v});var s=n(1601),r=n.n(s),o=n(6314),i=n.n(o)()(r());i.push([e.id,'/*********************************** Channel Modal ***********************************/\n.Ra7OduMuR7tus_A6cphM section[role="dialog"] {\n  /* main container for the modal */\n  margin-top: 2em;\n}\n.Ra7OduMuR7tus_A6cphM header {\n  /* top title */\n  min-height: 10px;\n  padding-top: 10px;\n  padding-bottom: 10px;\n}\n.Ra7OduMuR7tus_A6cphM header h2 {\n  /* top title */\n  width: 100%;\n  text-align: center;\n  font-size: 11pt;\n  color: var(--secondary-text-color);\n}\n.Ra7OduMuR7tus_A6cphM .rjOceXZEFw7XKdosxFP4 {\n  /* top stack, right of the avatar */\n  gap: 0px;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n.Ra7OduMuR7tus_A6cphM .PPGhfoNsGrDflm86hbDw {\n  /* channel name */\n  font-size: 19pt;\n  font-weight: 500;\n  margin-left: 10px;\n  margin-bottom: 12px;\n  line-height: 24pt;\n  /* avoid having a large gap between 2 lines of text, e.g. for "CoComelon Classroom - Learning for Kids" */\n  line-clamp: 2;\n  /* limit to 2 lines */\n  -webkit-line-clamp: 2;\n  overflow: hidden;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n}\n.Ra7OduMuR7tus_A6cphM .PPGhfoNsGrDflm86hbDw abbr {\n  /* channel name */\n  text-overflow: ellipsis;\n  overflow: hidden;\n  text-decoration: none;\n}\n.Ra7OduMuR7tus_A6cphM .Nn_KADTX5vFZpMhmcdv8 {\n  /* channel subs count */\n  margin-left: 10px;\n}\n.Ra7OduMuR7tus_A6cphM .dyJ4TnoQd6F8d49t6SUK {\n  /* last row under the channel name */\n  margin-bottom: 15px;\n  /* move up a bit from the very bottom */\n}\n.iu2_MS2JTHUu2Y_N5Mys {\n  margin-top: 10px;\n  margin-bottom: 10px;\n  max-height: 400px;\n  overflow: hidden scroll;\n  /* hide horizontal scrollbar. order: overflow-x, overflow-y */\n  display: block;\n}\n.Ra7OduMuR7tus_A6cphM .pT9rNlAKWUA1xg8cPvMl {\n  margin-top: 5px;\n}\n.Ra7OduMuR7tus_A6cphM .j6s0V56wtleq6KkEYl0P {\n  margin-top: 5px;\n}\n.Ra7OduMuR7tus_A6cphM .JWfFzked0UNaLLtlC_FS {\n  font-weight: normal;\n}\n.Ra7OduMuR7tus_A6cphM a {\n  color: var(--popup-link-color);\n  text-decoration-color: var(--popup-link-color);\n}\n[dark] .Ra7OduMuR7tus_A6cphM a {\n  /* when dark mode is enabled */\n  color: var(--dm-popup-link-color);\n  text-decoration-color: var(--dm-popup-link-color);\n}\n.Ra7OduMuR7tus_A6cphM .DKZaIB9B8UUmD1aLCRx2 {\n  margin-top: 5px;\n}\n.Ra7OduMuR7tus_A6cphM h2 a {\n  /* links in <h2> with icons */\n  font-weight: normal;\n}\n.Ra7OduMuR7tus_A6cphM .eqXfVunuEelpjgD9o3Su h2 {\n  /* each link\'s title/name in the last section */\n  font-size: 1em;\n}\n.RUeEEvUdsBlaUoPYBfMY .eqXfVunuEelpjgD9o3Su {\n  /* last section, containing links */\n  margin-bottom: 20px;\n}\n.eqXfVunuEelpjgD9o3Su {\n  text-overflow: ellipsis;\n  width: 99%;\n  white-space: nowrap;\n  overflow: hidden;\n}\n.eqXfVunuEelpjgD9o3Su h2 {\n  width: 59%;\n}\n.jBDMJ4tx0MqNsA04_Bwx {\n  margin-top: -6px;\n  margin-right: 2px;\n}\n.nIfNVGtfwhFj3QcMcJmG {\n  cursor: pointer;\n}\n.xv0ugLajgMKJcAVge0vg {\n  /* subs and published counts */\n  width: 70%;\n  gap: 0px;\n}\n.Ou3ydA_gDkqvmT9qEPkd {\n  /* subscribe button */\n  width: 25%;\n  margin-top: -52px;\n  position: relative;\n}\n.NXrqluzLKkKBIUe6uNLl {\n  display: block;\n  height: 13px;\n  /* this is for at least 2 \\n in a row, so we display a gap but not too much */\n  width: 100%;\n}\n/* shine effect on hover for the diamond play button */\n.KVshIXNJGF9mNER2jOv9 {\n  transition: 0.5s;\n  mask: linear-gradient(135deg, #000c 40%, #000, #000c 60%) 100% 100%/240% /* initial position, bottom-right */ 240%;\n  /* width and height */\n}\n.KVshIXNJGF9mNER2jOv9:hover {\n  mask-position: 0 0;\n  /* move to the top-left on hover */\n}\n.d1dZzEMNfR0FWmdwWhiK:hover {\n  transform: scale(1.2);\n}\n/* channel modal, loading */\n.E79oPHVmGYhnPgRadhlw {\n  margin-top: 10px;\n}\n.Re2Ux44ePZx1mgj79O8w {\n  margin-bottom: 10px;\n}\n',""]);var a="Ra7OduMuR7tus_A6cphM",l="rjOceXZEFw7XKdosxFP4",c="PPGhfoNsGrDflm86hbDw",h="Nn_KADTX5vFZpMhmcdv8",d="dyJ4TnoQd6F8d49t6SUK",u="iu2_MS2JTHUu2Y_N5Mys",p="JWfFzked0UNaLLtlC_FS",m="eqXfVunuEelpjgD9o3Su",g="RUeEEvUdsBlaUoPYBfMY",f="jBDMJ4tx0MqNsA04_Bwx",b="nIfNVGtfwhFj3QcMcJmG",v="xv0ugLajgMKJcAVge0vg",x="Ou3ydA_gDkqvmT9qEPkd",S="NXrqluzLKkKBIUe6uNLl",y="KVshIXNJGF9mNER2jOv9",k="d1dZzEMNfR0FWmdwWhiK",w="E79oPHVmGYhnPgRadhlw",C="Re2Ux44ePZx1mgj79O8w";const T=i},4010:(e,t,n)=>{n.d(t,{A:()=>a});var s=n(1601),r=n.n(s),o=n(6314),i=n.n(o)()(r());i.push([e.id,'.transcript-outer-container {\n  width: 100%;\n  padding: 12px;\n  border-radius: 12px;\n  border: 1px solid var(--mantine-color-gray-3);\n  margin-bottom: 16px;\n}\n[dark] .transcript-outer-container {\n  border: 1px solid #3e3e3e;\n}\n#transcript-block {\n  font-size: 14px;\n  padding: 0px 4px 0px 10px;\n  max-height: 500px;\n  overflow-y: auto;\n  margin-bottom: 0px;\n  margin-top: 12px;\n}\n#transcript-block:focus-visible,\n#transcript-block:focus {\n  outline: 2px solid transparent;\n}\n.transcript-block-stack {\n  background-color: transparent;\n}\n#transcript-btn-title {\n  font-family: "YouTube Sans", Roboto, sans-serif;\n  font-size: 18px;\n  font-weight: 700;\n  width: 100%;\n}\n#transcript-btn-title:focus-visible,\n#transcript-btn-title:focus {\n  outline: 2px solid transparent;\n}\n#transcript-block-slider {\n  padding-bottom: 20px;\n  margin-left: 12px;\n  flex: 3;\n}\n.ts-section {\n  align-items: flex-start;\n}\n.ts-section > .ts-text {\n  max-width: 100%;\n  color: var(--mantine-color-text);\n}\n.ts-section > .ts-text > .ts-time {\n  color: var(--mantine-color-red-7);\n  cursor: pointer;\n  font-weight: 600;\n  margin-right: 8px;\n  padding: 2px 4px 2px 4px;\n  border-radius: 4px;\n  user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n}\n.ts-section > .ts-text > .ts-time:hover {\n  color: white;\n  background-color: var(--mantine-color-red-7);\n}\n.ts-section > .ts-text > .ts-time.ts-time-rtl {\n  margin-right: 0px;\n  margin-left: 8px;\n}\n.ts-section > .ts-text > .ts-mark {\n  cursor: pointer;\n  background-color: transparent;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  color: var(--mantine-color-text);\n}\n[dark] .ts-section > .ts-text > .ts-mark {\n  color: var(--mantine-color-gray-3);\n}\n.ts-section > .ts-text > .ts-mark:hover {\n  background-color: var(--mantine-color-yellow-3);\n}\n[dark] .ts-section > .ts-text > .ts-mark:hover {\n  background-color: var(--mantine-color-yellow-4);\n  color: var(--mantine-color-dark-8);\n}\n.ts-section > .ts-text > .ts-mark.ts-mark-highlight {\n  background-color: var(--mantine-color-yellow-3);\n}\n[dark] .ts-section > .ts-text > .ts-mark.ts-mark-highlight {\n  background-color: var(--mantine-color-yellow-4);\n  color: var(--mantine-color-dark-8);\n}\n.ts-section > .ts-text > .ts-mark.ts-mark-highlight:hover {\n  background-color: var(--mantine-color-yellow-3);\n}\n[dark] .ts-section > .ts-text > .ts-mark.ts-mark-highlight:hover {\n  background-color: var(--mantine-color-yellow-4);\n}\n.ts-section > .ts-text > .ts-mark.ts-mark-search {\n  background-color: var(--mantine-color-orange-4);\n}\n[dark] .ts-section > .ts-text > .ts-mark.ts-mark-search {\n  background-color: var(--mantine-color-orange-6);\n  color: var(--mantine-color-dark-8);\n}\n.ts-section > .ts-text > .ts-mark.ts-mark-search:hover {\n  background-color: var(--mantine-color-orange-5);\n}\n.transcript-buttons-bar {\n  margin-top: 12px;\n  margin-bottom: 0px;\n}\nbutton.transcript-action-button {\n  flex: 1;\n}\nbutton.transcript-action-button:focus-visible,\nbutton.transcript-action-button:focus {\n  outline: 2px solid transparent;\n}\n.transcript-interface-config {\n  margin-top: 12px;\n  display: flex;\n  flex-direction: row;\n}\n#transcript-block-fieldset {\n  background-color: var(--mantine-color-transparent);\n  padding-bottom: 32px;\n  margin-top: -0.5em;\n  margin-bottom: 2px;\n  border-radius: 12px;\n  flex: 1;\n}\n.transcript-error {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n}\n.transcript-error-title {\n  font-size: 17px;\n  font-weight: 500;\n}\n.transcript-block-slider-mark {\n  padding: 2px;\n  margin-top: -2px;\n  transform: translateX(-2px);\n  background-color: var(--mantine-color-gray-3);\n}\n[dark] .transcript-block-slider-mark {\n  background-color: var(--mantine-color-dark-4);\n}\n.transcript-block-slider-mark[data-filled="true"] {\n  background-color: var(--slider-color);\n}\n.transcript-block-slider-mark-label {\n  font-size: var(--mantine-font-size-sm);\n  margin-top: -4px;\n  color: var(--mantine-color-gray-7);\n}\n[dark] .transcript-block-slider-thumb {\n  background-color: var(--mantine-color-white);\n}\n.transcript-language-selector {\n  width: 100%;\n  margin-top: 2px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  gap: 8px;\n}\n.transcript-language-selector-label {\n  flex: 1;\n  padding-left: 10px;\n}\n.transcript-language-selector-select {\n  flex: 3;\n}\n.transcript-language-selector-dropdown {\n  border: 1px solid #cacdcf;\n}\n[dark] .transcript-language-selector-dropdown {\n  border: 1px solid #3e3e3e;\n}\n.transcript-language-loading,\n.transcript-language-single-label {\n  font-size: 16px;\n  font-weight: 500;\n  width: 100%;\n  text-align: center;\n  margin-top: -3px;\n  margin-bottom: -3px;\n}\n.transcript-language-loading {\n  color: var(--mantine-color-gray-5);\n}\n.transcript-language-single-label {\n  color: var(--mantine-color-gray-7);\n}\n.transcript-search-bar {\n  margin-top: 6px;\n  padding-top: 5px;\n  display: flex;\n  flex-direction: row;\n  align-items: flex-end;\n  justify-content: space-between;\n  gap: 8px;\n}\n.transcript-search-bar-input {\n  flex: 10;\n}\n.transcript-search-bar-caret {\n  flex: 1;\n}\n.transcript-search-bar-input-not-found .mantine-TextInput-description {\n  color: var(--mantine-color-red-7);\n}\n.transcript-search-bar-input-not-found .mantine-Input-input {\n  border-color: var(--mantine-color-red-7);\n}\n.transcript-search-bar-input-one-of-several .mantine-TextInput-description {\n  color: var(--mantine-color-text);\n}\n',""]);const a=i},5940:(e,t,n)=>{n.d(t,{A:()=>a});var s=n(1601),r=n.n(s),o=n(6314),i=n.n(o)()(r());i.push([e.id,"/* prevent the close button from being highlighted as soon as the modal appears */\nbutton.mantine-Modal-close:focus-visible {\n  border: 0px;\n  outline: 0px;\n}\n/**************************************************************************************************************************/\n/* define a variable for the scrollbar width */\n:root {\n  --scrollbar-width: 8px;\n  --light-mode-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.2);\n  --dark-mode-box-shadow: inset 0 0 6px rgba(255, 255, 255, 0.2);\n  --light-mode-thumb-color: #f0f0f0;\n  --light-mode-thumb-hover-color: #bdbdbd;\n  --dark-mode-thumb-color: #363636;\n  --dark-mode-thumb-hover-color: #5f5f5f;\n}\ndiv.custom-scrollbar {\n  scrollbar-color: initial;\n  /* essential! this MUST be set to cancel out the default scrollbar-color set by Youtube */\n  /* the \"track\" is the background of the scrollbar */\n  /* this is the general scrollbar element */\n  /* the \"thumb\" is the draggable part of the scrollbar, what we click on */\n  /* hide scrollbar when no overflow (class added by JS) */\n}\ndiv.custom-scrollbar::-webkit-scrollbar-track {\n  -webkit-box-shadow: var(--light-mode-box-shadow);\n  box-shadow: var(--light-mode-box-shadow);\n  border-radius: 5px;\n  background-color: transparent;\n}\n@media (prefers-color-scheme: dark) {\n  div.custom-scrollbar::-webkit-scrollbar-track {\n    -webkit-box-shadow: var(--dark-mode-box-shadow);\n    box-shadow: var(--dark-mode-box-shadow);\n  }\n}\ndiv.custom-scrollbar::-webkit-scrollbar {\n  width: var(--scrollbar-width);\n  /* actual width of the scrollbar */\n  background-color: transparent;\n}\ndiv.custom-scrollbar::-webkit-scrollbar-thumb {\n  border-radius: calc(var(--scrollbar-width) / 2);\n  -webkit-box-shadow: var(--light-mode-box-shadow);\n  box-shadow: var(--light-mode-box-shadow);\n  background-color: var(--light-mode-thumb-color);\n}\n@media (prefers-color-scheme: dark) {\n  div.custom-scrollbar::-webkit-scrollbar-thumb {\n    -webkit-box-shadow: var(--dark-mode-box-shadow);\n    box-shadow: var(--dark-mode-box-shadow);\n    background-color: var(--dark-mode-thumb-color);\n  }\n}\ndiv.custom-scrollbar:hover::-webkit-scrollbar-thumb {\n  background-color: var(--light-mode-thumb-hover-color);\n}\n@media (prefers-color-scheme: dark) {\n  div.custom-scrollbar:hover::-webkit-scrollbar-thumb {\n    background-color: var(--dark-mode-thumb-hover-color);\n  }\n}\ndiv.custom-scrollbar:not(.has-overflow)::-webkit-scrollbar {\n  width: 0px;\n  background: transparent;\n}\n.mantine-Modal-content {\n  overflow-y: scroll;\n  scrollbar-width: none;\n}\n/**************************************************************************************************************************/\n.modal-subscribe {\n  width: 118px;\n  height: 36px;\n}\n.rainbow {\n  --angle: 0deg;\n  width: 118px;\n  height: 36px;\n  position: relative;\n  border: none;\n  border-radius: 32px;\n  z-index: 2;\n  cursor: pointer;\n}\n.rainbow:hover::before {\n  content: '';\n  position: absolute;\n  inset: -2px;\n  background: conic-gradient(from var(--angle), red, yellow, lime, aqua, blue, magenta, red);\n  border-radius: inherit;\n  z-index: -1;\n  animation: 2s rotate linear infinite;\n}\n@keyframes rotate {\n  to {\n    --angle: 360deg;\n  }\n}\n@property --angle {\n  syntax: '<angle>';\n  initial-value: 0deg;\n  inherits: false;\n}\n:root {\n  --progress-bar-tick-width: 3.5px;\n  --progress-bar-tick-height: 15px;\n  --progress-bar-tick-vertical-offset: 4px;\n}\ndiv.cfy-ext-progress-bar-tick-wrapper {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n}\ndiv.cfy-ext-progress-bar-tick {\n  position: absolute;\n  width: var(--progress-bar-tick-width);\n  height: var(--progress-bar-tick-height);\n  top: calc(-1 * var(--progress-bar-tick-height) + var(--progress-bar-tick-vertical-offset));\n  margin-left: calc(-1 * var(--progress-bar-tick-width) / 2);\n  border-radius: var(--progress-bar-tick-width);\n}\n.ytp-progress-bar-container:hover div.cfy-ext-progress-bar-tick {\n  height: calc(var(--progress-bar-tick-height) - var(--progress-bar-tick-vertical-offset));\n  top: calc(-1 * calc(var(--progress-bar-tick-height) - var(--progress-bar-tick-vertical-offset)));\n}\n.cfy-ext-progress-bar-tick-gray {\n  background-color: rgba(149, 149, 149, 0.65);\n}\n.cfy-ext-progress-bar-tick-red {\n  background-color: #f03;\n}\n",""]);const a=i},7349:(e,t,n)=>{n.d(t,{Ay:()=>p,HN:()=>h,Xi:()=>d,i:()=>u,ni:()=>c,qr:()=>a,u5:()=>l});var s=n(1601),r=n.n(s),o=n(6314),i=n.n(o)()(r());i.push([e.id,"/*********************************** Right Column Container ***********************************/\n.i6_GXtMszt0yg_A1zkWh {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n/**\n * This element has a height of 0px but *does* create a vertical gap that we need.\n * It's because the parent element has a flex-direction of column, with a gap of 10px; so even though this element has no height, it still creates a gap.\n * If we remove this element, the gap disappears and the playlist gets stuck to the bottom of the buttons bar.\n */\n.SwQgkMyyeRy1AduJv80w {\n  height: 0px;\n  margin: 0px;\n}\n/*********************************** Right Column Buttons Bar ***********************************/\n.dS7LNQkvsHrHTWmPr5rd {\n  display: flex;\n  flex-direction: row;\n  gap: 10px;\n  margin-top: 4px;\n  margin-bottom: 4px;\n  justify-content: space-between;\n}\n:root {\n  --btn-buttons-bar-bg-color: #f2f2f2;\n  --btn-buttons-bar-bg-color-hover: #e5e5e5;\n  --btn-buttons-bar-bg-color-dark: #262626;\n  --btn-buttons-bar-bg-color-hover-dark: #3e3e3e;\n}\n.qz55XCEX_sxrnRAFp50h {\n  cursor: pointer;\n  background-color: var(--btn-buttons-bar-bg-color);\n  border-width: 0px;\n}\n.qz55XCEX_sxrnRAFp50h:hover {\n  background-color: var(--btn-buttons-bar-bg-color-hover);\n}\n.qz55XCEX_sxrnRAFp50h:focus-visible {\n  outline-color: transparent;\n}\n[dark] .qz55XCEX_sxrnRAFp50h {\n  background-color: var(--btn-buttons-bar-bg-color-dark);\n}\n[dark] .qz55XCEX_sxrnRAFp50h:hover {\n  background-color: var(--btn-buttons-bar-bg-color-hover-dark);\n}\n.xaTgEMtTIQTQXbtaYQoI {\n  background-color: var(--btn-buttons-bar-bg-color-hover);\n}\n[dark] .xaTgEMtTIQTQXbtaYQoI {\n  background-color: var(--btn-buttons-bar-bg-color-hover-dark);\n}\n.qz55XCEX_sxrnRAFp50h span {\n  font-size: 14px;\n}\n.Gs0lyhCYWl885zpPQHm2 {\n  margin-right: 3px;\n}\n",""]);var a="i6_GXtMszt0yg_A1zkWh",l="SwQgkMyyeRy1AduJv80w",c="dS7LNQkvsHrHTWmPr5rd",h="qz55XCEX_sxrnRAFp50h",d="xaTgEMtTIQTQXbtaYQoI",u="Gs0lyhCYWl885zpPQHm2";const p=i},7745:(e,t,n)=>{var s=n(4848),r=n(1448);const o=1e3;class i{static MONITOR_FREQ_MSEC=150;static DETECT_LOOP_SEC_BEFORE_END=2;static DETECT_LOOP_WITHIN_SEC_AFTER_START=2;static DETECT_JUMP_WHEN_TIME_MOVE_BY_SEC=1;static SHORTCUT_PLUS_TEN_SEC_L={shortcut:r.Shortcuts.simple("l"),enabled:!0}}if(i.DETECT_LOOP_SEC_BEFORE_END<=i.MONITOR_FREQ_MSEC/1e3)throw new Error("TIME_JUMP_DETECT_LOOP_SEC_BEFORE_END must be greater than TIME_JUMP_MONITOR_FREQ_MSEC / 1000");if(i.DETECT_LOOP_WITHIN_SEC_AFTER_START<=i.MONITOR_FREQ_MSEC/1e3)throw new Error("TIME_JUMP_DETECT_LOOP_WITHIN_SEC_AFTER_START must be greater than TIME_JUMP_MONITOR_FREQ_MSEC / 1000");const a="keydown",l={Space:"Pause/Resume the Short",KeyK:"Pause/Resume the Short",KeyJ:"Jump backward 10 seconds",KeyL:"Jump forward 10 seconds",Comma:"Move video back one frame",Period:"Move video forward one frame"},c=[{maxTimeSec:30,minChars:150,maxChars:300,absoluteMaxChars:300,preferSentenceBoundary:!0,label:"Short",tickMark:"S"},{maxTimeSec:60,minChars:300,maxChars:500,absoluteMaxChars:500,preferSentenceBoundary:!0,label:"Medium",tickMark:"M"},{maxTimeSec:90,minChars:450,maxChars:1e3,absoluteMaxChars:700,preferSentenceBoundary:!0,label:"Long",tickMark:"L"}],h="ts-mark-highlight";class d{static MAX_ATTEMPTS=3;static DELAY_MILLIS=1e3}const u=2500,p=1e6;function m(e){e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault()}var g,f;g||(g={}),function(e){e.CSS_INJECT_COMMON_STYLES="B2C_CSS_INJECT_COMMON_STYLES"}(f||(f={}));let b=null;function v(e,t){null!==b&&(b.remove(),b=null);const n=document.createElement("tp-yt-paper-toast");n.innerText=e,n.classList.add("toast-open");Object.assign(n.style,{outline:"none",position:"fixed",left:"0",bottom:"12px",maxWidth:"300px",minWidth:"180px",paddingRight:"20px",maxHeight:"48px",zIndex:"2202",opacity:"1"}),document.body.appendChild(n),b=n,setTimeout((()=>{n.style.display="block"}),0),setTimeout((()=>{n.style.transform="none"}),10),setTimeout((()=>{n.style.transform="translateY(200%)"}),Math.max(0,t))}function x(e){const t=Date.now();for(const e of Array.from(document.querySelectorAll("tp-yt-paper-toast")))if(e.textContent?.toLowerCase().includes("feedback shared with the creator"))return void e.remove();if(t-e<1e3){setTimeout((()=>x(e)),t-e<100?10:50)}}function S(){const e=new URL(location.href);if(E())return e.searchParams.get("v");if(T()){const e=/^\/(shorts)\/([0-9a-zA-Z-_]+)$/.exec(location.pathname);return e?e[2]:null}return null}function y(e){return e.startsWith("/channel/")?function(e){return e.replaceAll(/^.*\/channel\/([^/]+)(\/.+)?$/g,"$1")}(e):e.startsWith("/@")?k(e):null}function k(e){return e.replaceAll(/^.*\/(@[^/]+)(\/.+)?$/g,"$1")}function w(e){const t=function(e){const t=document.querySelector("div#social-links a[aria-label]"),n=t?.getAttribute("href");return e.debug("Social links div:",t,"href:",n),t&&n?y(n):(e.debug("No social links div found"),null)}(e);return t?(e.debug("Regular watch viewer, found channel ID from social links:",t),t):null}function C(e){return E()?w(e):T()?function(e){const t=Array.from(document.querySelectorAll("div#metapanel a[href]"));e.debug("Shorts viewer, anchors:",t);for(const n of t){const t=n.getAttribute("href"),s=t?y(t):null;if(s)return e.debug("Shorts viewer, found channel ID:",s),s}return null}(e):null}function T(){return/^\/(shorts)/.test(location.pathname)}function E(){return/^\/(watch)/.test(location.pathname)||/^\/live\/[a-zA-Z0-9_-]{8,}/.test(location.pathname)}function M(e){const t=e.getBoundingClientRect(),n=t.top,s=t.bottom;return n>=0&&s<=window.innerHeight&&![t.left,t.right,t.top,t.bottom].every((e=>0===e))}function I(e,t){return function(e,t){return Array.from(document.querySelectorAll(e)).filter((e=>M(e))).map((e=>e.querySelector(t))).filter((e=>!0))}(e,t).filter((e=>null!==e)).filter((e=>M(e))).find((e=>!0))}function O(e){return document.querySelector(e)}function A(e){return e.hasAttribute("aria-pressed")?e.getAttribute("aria-pressed"):null}function N(e,t=!1){const n=Math.floor(e/3600),s=Math.floor(e%3600/60),r=Math.floor(e%60),o=Math.floor(1e3*(e-Math.floor(e)));return(n>0?(""+n).padStart(2,"0")+":":"")+(""+s).padStart(2,"0")+":"+(""+r).padStart(2,"0")+(t?"."+(""+o).padStart(3,"0"):"")}function j(e){return e===Math.floor(e)?e+"x":e.toFixed(2).endsWith("0")?e.toFixed(1)+"x":e.toFixed(2)+"x"}function R(e){return!isNaN(e.duration)}function P(){const e=Array.from(document.querySelectorAll("video")).filter((e=>R(e)));return 0===e.length?null:e[0]}function B(e,t,n){navigator.clipboard.writeText(e).then(t).catch(n)}var V,L,F=n(5310),_=n(9731);!function(e){e[e.none=1]="none",e[e.showNotification=2]="showNotification"}(V||(V={})),function(e){e[e.startPlaying=1]="startPlaying",e[e.keepCurrentState=2]="keepCurrentState",e[e.preserveSavedState=3]="preserveSavedState"}(L||(L={}));class D{static matchesEvent(e,t,n){const s=r.Shortcuts.fromKeyDownEvent(n,r.CapsLock.Remove);return D.matchesShortcut(e,t,s,n)}static matchesShortcut(e,t,n,s){return!!t.enabled&&(!!r.Shortcuts.equals(n,t.shortcut)&&(H(e,t.shortcut,s),z(s),!0))}}function U(e,t=V.none,n=!0){return{shortcut:e,feedback:t,enabled:n}}function W(e,t=!1,n=!0){return{shortcut:e,enabled:n,showProgressBar:t}}function z(e){e.preventDefault(),e.stopPropagation()}function H(e,t,n){e.logger.trace("Matched shortcut",t,"for event",n)}var $;!function(e){e.Top="top",e.Middle="middle",e.Bottom="bottom"}($||($={}));const J={likeVideo:U(r.Shortcuts.keyAndCode("[","BracketLeft"),V.showNotification),dislikeVideo:U(r.Shortcuts.keyAndCode("]","BracketRight"),V.showNotification),pictureInPicture:U(r.Shortcuts.simple("h")),openTranscript:U(r.Shortcuts.simple("g")),channelInfo:U(r.Shortcuts.simple("y")),watchNextOverlays:U(r.Shortcuts.newEmpty(),void 0,!1),progressBarTicks:U(r.Shortcuts.keyAndCode("`","Backquote")),speedFaster:U(r.Shortcuts.shifted(r.Shortcuts.keyAndCode("}","BracketRight")),V.showNotification),speedSlower:U(r.Shortcuts.shifted(r.Shortcuts.keyAndCode("{","BracketLeft")),V.showNotification),shortsOpenComments:U(r.Shortcuts.simple("c")),shortsSwitchToRegular:U(r.Shortcuts.simple("w")),shortsSwitchToRegularNewWindow:U(r.Shortcuts.shifted(r.Shortcuts.simple("w"))),shortsFullscreen:U(r.Shortcuts.simple("f"))},q={bookmarkBackup:U(r.Shortcuts.simple("b"),V.showNotification),bookmarkDelete:U(r.Shortcuts.simple("B"),V.showNotification),bookmarkRestore:U(r.Shortcuts.simple("r"),V.showNotification),undoJump:U(r.Shortcuts.simple("u")),deleteOnRestore:!1},X={oneMinus:W(r.Shortcuts.simple("z")),onePlus:W(r.Shortcuts.simple("x")),oneValue:3,twoMinus:W(r.Shortcuts.shifted(r.Shortcuts.simple("z"))),twoPlus:W(r.Shortcuts.shifted(r.Shortcuts.simple("x"))),twoValue:1},K=e=>({enabled:e,feedback:V.none}),G=()=>K(!0),Y={shortsEnableZeroToNine:G(),shortsMinusTenSec:G(),shortsPlusTenSec:G(),shortsNextVideo:G(),shortsPreviousVideo:G(),shortsPreviousFrame:G(),shortsNextFrame:G(),skip5SecOverlays:G(),removeWatchNextOverlays:K(!1),addRightColumnButtons:G(),enableNotificationEmojis:G(),shortsAutoPlayNext:G(),pauseResumeOnChannelModal:G(),openLinksInNewTab:G(),removeProgressGradient:G()},Z={speedChangeAmount:{enabled:!0,amount:5},bookmarkMaxAge:{enabled:!0,amount:24},bookmarkMaxVideos:{enabled:!0,amount:100},notificationsDurationMs:{enabled:!0,amount:2e3}},Q={preferredLanguage:"en-US",defaultBlockSizeIndex:1,transcriptHighlightPosition:$.Middle};class ee{static load(e){ee.loadAndMaybeReSave(e,!1)}static loadAndRepair(e){ee.loadAndMaybeReSave(e,!0)}static loadAndMaybeReSave(e,t){const n=F.Logger.defaultLogger();n.debug(`UserPrefsLoader::loadAndMaybeReSave(canSave=${t})`),_.sV.get(_.cY.PREFS,(s=>{if(n.debug("UserPrefsLoader::RAW PREFS:",s[_.cY.PREFS]),s[_.cY.PREFS]){const n=ee.validateAndRebuildUserPrefsObjects(s[_.cY.PREFS],t);0,(0,_.Z)(n,s[_.cY.PREFS])||n.logger.debug("UserPrefsLoader::REPAIRED PREFS, NOW:",n),e(n)}else ee.initStorage(e)}))}static initStorage(e){const t=ee.create();t.logger.debug("[UserPrefs::initStorage] create returned",t),_.sV.set(_.cY.PREFS,t,(()=>{e(t)}))}static create(){return{savedAt:Date.now(),logLevel:F.Logger.defaultLevel(),logger:F.Logger.defaultLogger(),keys:J,backupRestore:q,manualTimeSkips:X,generalBoolOptions:Y,generalNumberOptions:Z,transcriptOptions:Q}}static delete(e=()=>{}){_.sV.delete(_.cY.PREFS,(()=>{e&&e()}))}static validateAndRebuildUserPrefsObjects(e,t){const n=structuredClone(e),s={},r=ee.create();Object.assign(s,e),s.logLevel&&"number"==typeof s.logLevel||(s.logLevel=r.logLevel),s.logger=new F.Logger(s.logLevel);ee.validateUserPrefsObject(s)||(s.logger.debug("Replacing saved user preferences with clean slate"),Object.assign(s,r)),s.keys=(0,_.$p)("keys",s.keys,r.keys,s.logger),s.manualTimeSkips=(0,_.$p)("manualTimeSkips",s.manualTimeSkips,r.manualTimeSkips,s.logger),s.backupRestore=(0,_.$p)("backupRestore",s.backupRestore,r.backupRestore,s.logger),s.generalBoolOptions=(0,_.$p)("generalBoolOptions",s.generalBoolOptions,r.generalBoolOptions,s.logger),s.generalNumberOptions=(0,_.$p)("generalNumberOptions",s.generalNumberOptions,r.generalNumberOptions,s.logger),s.transcriptOptions=(0,_.$p)("transcriptOptions",s.transcriptOptions,r.transcriptOptions,s.logger);const o=Object.keys(s);for(const e of o)e in r||delete s[e];return t&&!(0,_.Z)(s,n)&&ee.saveUserPrefsIfPossible(s),s}static saveUserPrefsIfPossible(e){e.logger&&e.logger.debug("Storing user prefs directly"),ee.save(e,(()=>{e.logger&&e.logger.debug("User prefs stored")}))}static validateUserPrefsObject(e){return(0,_.Or)(e,ee.create())}static save(e,t=()=>{}){e.logger&&e.logger.debug("[UserPrefs::save]");const n=structuredClone(e);(0,_.kA)(n),delete n.logger,_.sV.set(_.cY.PREFS,n,t)}}function te(e,t,n,s){if(null!==t){const e=`https://youtube.com/watch?v=${t}${null===n?"":`&t=${Math.floor(n.currentTime)}`}`;s?(n.pause(),window.open(e,"_blank")):location.href=e}else v("Could not switch to the classic player",e.generalNumberOptions.notificationsDurationMs.amount)}var ne;!function(e){e[e.NO_MATCH=0]="NO_MATCH",e[e.OPEN_IN_SAME_TAB=1]="OPEN_IN_SAME_TAB",e[e.OPEN_IN_NEW_TAB=2]="OPEN_IN_NEW_TAB"}(ne||(ne={}));var se=n(4988);class re{prefs;onMonitorTickInterval=null;onVideoIdChangeCbs=[];onUrlChangeCbs=[];onShortVideoLoopCbs=[];lastVideoId=null;lastUrl="";wasNearEnd=!1;lastObservation=null;lastJumpTimeSec=null;suppressNextJump=!1;constructor(e){this.prefs=e,this.prefs}updatePrefs(e){this.prefs=e}startMonitoring(){this.lastVideoId=S(),this.lastUrl=location.href,this.wasNearEnd=!1,this.lastObservation=null,this.lastJumpTimeSec=null,this.suppressNextJump=!1,this.onMonitorTickInterval=setInterval((()=>this.onMonitorTick()),i.MONITOR_FREQ_MSEC)}stopMonitoring(){this.onMonitorTickInterval&&(clearInterval(this.onMonitorTickInterval),this.onMonitorTickInterval=null,this.lastVideoId=null,this.lastUrl="",this.wasNearEnd=!1,this.lastObservation=null,this.lastJumpTimeSec=null,this.suppressNextJump=!1)}registerVideoIdChangeCb(e){this.onVideoIdChangeCbs.push(e)}registerUrlChangeCb(e){this.onUrlChangeCbs.push(e)}registerShortVideoLoopCb(e){this.onShortVideoLoopCbs.push(e)}getVideoTimeBeforeLastJump(){const e=this.lastJumpTimeSec;return this.lastJumpTimeSec=null,this.suppressNextJump=!0,e}onMonitorTick(){const e=S(),t=location.href,n=P(),s=T();if(e!==this.lastVideoId&&null!==e&&(this.prefs.logger.debug(`Video ID changed from ${this.lastVideoId} to ${e}`),this.onVideoIdChangeCbs.forEach((t=>t(this.lastVideoId,e))),this.lastVideoId=e,this.wasNearEnd=!1,this.lastJumpTimeSec=null,this.lastObservation=null,this.suppressNextJump=!1),t!==this.lastUrl&&(this.onUrlChangeCbs.forEach((e=>e(this.lastUrl,t))),this.lastUrl=t),!n||!e)return void(this.lastObservation=null);const r=n.currentTime,o=Date.now(),a=n.playbackRate,l=n.paused,c=n.duration;if(!isFinite(r)||!isFinite(c)||c<=0)this.lastObservation=null;else{if(this.suppressNextJump)this.suppressNextJump=!1;else if(null!==this.lastObservation){const e=r-this.lastObservation.videoTimeSec;let t;if(l)t=0;else{t=(o-this.lastObservation.realTimeMs)/1e3*this.lastObservation.playbackRate}const n=e-t;Math.abs(n)>i.DETECT_JUMP_WHEN_TIME_MOVE_BY_SEC&&(this.lastJumpTimeSec=this.lastObservation.videoTimeSec)}this.lastObservation={videoTimeSec:r,realTimeMs:o,playbackRate:a},s&&e===this.lastVideoId?this.wasNearEnd?r<=i.DETECT_LOOP_WITHIN_SEC_AFTER_START?(this.prefs.logger.debug("Detected Short video loop"),this.onShortVideoLoopCbs.forEach((e=>e())),this.wasNearEnd=!1):r<c-i.DETECT_LOOP_SEC_BEFORE_END&&(this.wasNearEnd=!1,this.prefs.logger.debug("No longer near the end of the video, reset wasNearEnd")):r>=c-i.DETECT_LOOP_SEC_BEFORE_END&&(this.wasNearEnd=!0,this.prefs.logger.debug("We are near the end of the Short video")):this.wasNearEnd=!1}}}function oe(e,t){se.X.remove(e,t)}function ie(e,t){const n=Math.max(0,Math.min(e.duration,e.currentTime+t));e.currentTime=n}function ae(e){return atob(e).split("").map(((e,t)=>String.fromCharCode(e.charCodeAt(0)^t+42))).join("")}function le(e){for(const t of e.captionTracks)if(t.baseUrl.includes("&exp=xpe"))return!1;return!0}async function ce(e,t){const n=await fetch(`https://www.youtube.com/watch?v=${e}`,{method:"GET",credentials:"omit",headers:{"Accept-Language":"en-US",...t?{Cookie:t}:{}}});return await n.text()}async function he(e,t,n=!0){const s=await fetch(`https://www.youtube.com/youtubei/v1/player?key=${t}`,{method:"POST",credentials:n?"omit":"include",headers:{"Accept-Language":"en-US"},body:JSON.stringify({context:{client:{clientName:ae("a2Vof2FmdA=="),clientVersion:ae("GBsCHB4BAwk=")}},videoId:e})});return await s.json()}function de(e){const t=e?.playabilityStatus;return"OK"===t?.status}function ue(e){const t=ae("TEZYEF1dRgI=");return e.map((e=>{return{...e,name:pe(e.name),baseUrl:(n=e.baseUrl,n.replace("&"+t,"").replace(t+"&",""))};var n}))}function pe(e){return 0!==e.runs.length&&"object"==typeof e.runs[0]&&"text"in e.runs[0]?{simpleText:e.runs[0].text}:"simpleText"in e&&"string"==typeof e.simpleText?{simpleText:e.simpleText}:{simpleText:"(unknown)"}}function me(e,t,n,s){const r=e,o=t.length;let i=-1*o;for(;i<r.length&&(i=r.indexOf(t,i+o),!(i<0));){let e=i+o,t=0,a=e;for(;a<r.length;){if("{"===r[a])0===t&&(e=a),t++;else if("}"===r[a]&&(t--,0===t))break;a++}if(0!==t);else{const t=r.substring(e,a+1);try{const e=JSON.parse(t);if(n(e))return s(e)}catch(e){}}}return null}var ge,fe,be,ve=n(4354);class xe{static instance=new xe;basicVideoMetadata={};videoMetadata={};channelMetadata={};MAX_AGE_MS=36e5;MAX_SIZE=100;constructor(){}static getInstance(){return xe.instance}cleanupCache(e){(0,ve.A)(e,this.MAX_AGE_MS,this.MAX_SIZE)}getBasicVideoInfo(e){return this.cleanupCache(this.basicVideoMetadata),this.basicVideoMetadata[e]?.data||null}setBasicVideoInfo(e,t){return this.cleanupCache(this.basicVideoMetadata),this.basicVideoMetadata[e]={data:t,savedAt:Date.now()},t}getVideoMetadata(e){return this.cleanupCache(this.videoMetadata),this.videoMetadata[e]?.data||null}setVideoMetadata(e,t){return this.cleanupCache(this.videoMetadata),this.videoMetadata[e]={data:t,savedAt:Date.now()},t}getChannelMetadata(e){return this.cleanupCache(this.channelMetadata),this.channelMetadata[e]?.data||null}setChannelMetadata(e,t){return this.cleanupCache(this.channelMetadata),this.channelMetadata[e]={data:t,savedAt:Date.now()},t}}!function(e){e[e.Other=0]="Other",e[e.Website=1]="Website",e[e.Blogspot=2]="Blogspot",e[e.Cameo=3]="Cameo",e[e.Discord=4]="Discord",e[e.Facebook=5]="Facebook",e[e.Instagram=6]="Instagram",e[e.Patreon=7]="Patreon",e[e.Substack=8]="Substack",e[e.Threads=9]="Threads",e[e.Tiktok=10]="Tiktok",e[e.Twitter=11]="Twitter",e[e.Wordpress=12]="Wordpress"}(ge||(ge={})),function(e){e[e.Subscribed=0]="Subscribed",e[e.NotSubscribed=1]="NotSubscribed",e[e.Unknown=2]="Unknown"}(fe||(fe={})),function(e){e[e.DomainMatch=2]="DomainMatch",e[e.TitleMatch=1]="TitleMatch",e[e.Guess=0]="Guess"}(be||(be={}));const Se=[{type:ge.Blogspot,domain:"blogspot.com"},{type:ge.Cameo,domain:"cameo.com"},{type:ge.Discord,domain:"discord.com"},{type:ge.Discord,domain:"discord.gg"},{type:ge.Facebook,domain:"facebook.com"},{type:ge.Instagram,domain:"instagram.com"},{type:ge.Patreon,domain:"patreon.com"},{type:ge.Substack,domain:"substack.com"},{type:ge.Threads,domain:"threads.net"},{type:ge.Tiktok,domain:"tiktok.com"},{type:ge.Twitter,domain:"twitter.com"},{type:ge.Twitter,domain:"x.com"},{type:ge.Wordpress,domain:"wordpress.com"}];const ye={clientName:"WEB",clientVersion:"2.20240416.01.00"};class ke{prefs;constructor(e){this.prefs=e}async fetchVideoPagePlayerForVideoId(e){const t=await this.youTubeIJsonRequest("/player",{videoId:e});return this.videoMetadataFromBrowseResponse(e,t)}async youTubeIJsonRequest(e,t){const n={context:{client:ye},...t};return await fetch(`https://www.youtube.com/youtubei/v1${e}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(n)}).then((e=>e.json()))}async videoMetadataFromBrowseResponse(e,t){this.prefs.logger.debug("videoMetadata (browseResponse):",t);const n=t?.videoDetails?.title,s=t?.videoDetails?.lengthSeconds,r=Number.parseInt(t?.videoDetails?.viewCount||"-1"),o=t?.videoDetails?.keywords||[],i=t?.videoDetails?.shortDescription||"",a=t?.videoDetails?.isPrivate||!1,l=t?.microformat?.playerMicroformatRenderer,c=l?.thumbnail?.thumbnails,h=l?.description?.simpleText||"",d=l?.category||"",u=l?.isFamilySafe||!1,p=l?.isUnlisted||!1,m=this.parseDate(l?.publishDate||""),g=this.parseDate(l?.uploadDate||""),f=t?.videoDetails?.thumbnail?.thumbnails;var b=-1,v=-1,x="",S="";if(f&&Array.isArray(f)){const e=f;c&&Array.isArray(c)&&e.push(...c);for(const t of[!0,!1])for(const n of e)if(n.width&&n.height){const e=n.width*n.height;t&&e>b&&(b=e,S=n.url),!t&&e>v&&e<b&&(v=e,x=n.url)}}return{videoId:e,title:n,durationSec:s,channelId:e,keywords:o,description:h,shortDescription:i,category:d,thumbnailLargeUrl:x,thumbnailMaxResUrl:S,viewCount:r,isPrivate:a,isFamilySafe:u,isUnlisted:p,publishDate:m,uploadDate:g}}parseDate(e){if(""===e)return null;try{return new Date(Date.parse(e.trim()))}catch(t){return this.prefs.logger.debug("Failed to parse date:",e),null}}extractSubscribeButtonAndState(){var e=fe.Unknown,t=null;const n=[];if(!E()||e!=fe.Unknown&&e!=fe.NotSubscribed){if(T()&&(e==fe.Unknown||e==fe.NotSubscribed)){const e=Array.from(document.querySelectorAll("div#metapanel yt-subscribe-button-view-model")).filter((e=>M(e))).map((e=>e.querySelector("button"))).filter((e=>e&&e instanceof HTMLButtonElement));n.push(...e)}}else n.push(...Array.from(document.querySelectorAll("div#owner div#subscribe-button button")));for(const s of n){const n=s.ariaLabel?.toLowerCase()||"",r=s.textContent?.toLowerCase()||"",o=n.includes("subscribed")||r.includes("subscribed")||n.includes("unsubscribe")||r.includes("unsubscribe"),i=!n.includes("subscribed")&&!r.includes("subscribed")&&(n.includes("subscribe")||r.includes("subscribe"));if(o&&!i){e=fe.Subscribed,t=s;break}if(i&&!o){e=fe.NotSubscribed,t=s;break}e=fe.Unknown,t=null}return e==fe.Unknown&&T()&&(e=fe.Subscribed),{button:t,subscription:e}}async fetchMetadataByChannelUrl(e){return me(await fetch(e).then((e=>e.text())),"var ytInitialData",(e=>!0),(e=>e))}async fetchChannelIdFromVideoId(e){const t=me(await fetch(`https://www.youtube.com/watch?v=${e}`).then((e=>e.text())),"var ytInitialData",(e=>!0),(e=>e)),n=JSON.stringify(t),s='channelId":"',r=n.indexOf(s),o=r<0?-1:n.indexOf('"',r+12+1);return r<0||o<0?Promise.reject("Failed to fetch channel page"):n.substring(r+12,o)}async fetchChannelMetadataContinued(e,t){let n=await this.fetchMetadataByChannelUrl(e);if(!n&&t){const e=await this.fetchChannelIdFromVideoId(t);e&&(n=await this.fetchMetadataByChannelUrl(`https://www.youtube.com/channel/${e}`))}if(!n)return Promise.reject("Failed to fetch channel page");const s=n?.header?.pageHeaderRenderer?.content?.pageHeaderViewModel?.description?.descriptionPreviewViewModel,r=s?.rendererContext?.commandContext?.onTap,o=e=>e.split("").reverse().join(""),i=r?.[o("utrenni")+o("dnammoCeb")]?.showEngagementPanelEndpoint?.engagementPanel,a=i?.engagementPanelSectionListRenderer?.content?.sectionListRenderer?.contents;var l="",c=null,h="";if(a&&Array.isArray(a))for(const e of a){const t=e?.itemSectionRenderer?.contents;if(t&&Array.isArray(t))for(const e of t){[c,h,l]=[null,"",""];const t=e?.continuationItemRenderer?.continuationEndpoint,n=t?.commandMetadata?.webCommandMetadata;n&&"sendPost"in n&&"apiUrl"in n&&(c=n.sendPost,h=n.apiUrl);const s=t?.continuationCommand;if(s&&"token"in s&&(l=s.token),l&&c&&h)break}}if(!(l&&c&&h))return Promise.reject("Failed to find continuation data");const d=await fetch(h,{headers:{"Content-Type":"application/json"},method:c?"POST":"GET",body:JSON.stringify({context:{client:ye},continuation:l})}).then((e=>e.json()));return this.combineChannelMetadata(n,d)}extractChannelThumbnail(e){const t=e?.metadata?.channelMetadataRenderer?.avatar?.thumbnails;return t&&Array.isArray(t)?this.largestImageUrlOf(t):null}combineChannelMetadata(e,t){const n=e?.metadata?.channelMetadataRenderer?.title,s=e?.metadata?.channelMetadataRenderer?.description,r=this.extractChannelThumbnail(e),o=e?.metadata?.channelMetadataRenderer?.ownerUrls,i=o&&Array.isArray(o)&&o.length>0?o[0]:null,a=e?.metadata?.channelMetadataRenderer?.externalId,l=e?.metadata?.channelMetadataRenderer?.facebookProfileId,c=l?`https://facebook.com/${l}`:null,h=e?.header?.pageHeaderRenderer?.content?.pageHeaderViewModel?.attribution?.attributionViewModel?.text?.content;var d=-1,u=-1,p=-1,m="",g=null,f=[{name:"Website",type:ge.Website,confidence:h?be.DomainMatch:be.Guess,url:h?this.ensureScheme(h):"",image:""},{name:"Facebook",type:ge.Facebook,confidence:c?be.DomainMatch:be.Guess,url:c?this.ensureScheme(c):"",image:""}],b=structuredClone(f);const v=t?.onResponseReceivedEndpoints;if(v&&Array.isArray(v))for(const e of v){const t=e?.appendContinuationItemsAction?.continuationItems;if(t&&Array.isArray(t))for(const e of t){const t=e?.aboutChannelRenderer?.metadata?.aboutChannelViewModel,n=t?.subscriberCountText;n&&"string"==typeof n&&n.match(/^.+ subscribers?$/g)&&(d=(x=n.replace(/ subscribers?$/,"")).endsWith("M")?1e6*parseFloat(x.slice(0,-1)):x.endsWith("K")?1e3*parseFloat(x.slice(0,-1)):parseInt(x));const s=t?.viewCountText;s&&"string"==typeof s&&s.match(/^.+ views?$/g)&&(p=parseInt(s.replace(/ views?$/,"").replaceAll(",","")));const r=t?.joinedDateText?.content;if(r)try{g=new Date(Date.parse(r.replace(/^Joined /,"")))}catch(e){}const o=t?.videoCountText;o&&"string"==typeof o&&o.match(/^.+ videos?$/g)&&(u=parseInt(o.replace(/ videos?$/,"").replaceAll(",","")));const i=t?.country;i&&(m=i);const a=t?.links;if(a&&Array.isArray(a)){const e=a.filter((e=>"channelExternalLinkViewModel"in e)),t=this.extractChannelLinks(e);t&&t.length>=b.length&&(b=t)}}}var x;const S=this.extractSubscribeButtonAndState();return{name:n?.trim()??"",description:s?.trim()??"",avatarUrl:r??"",channelUrl:i??"",channelId:a??"",links:b,subsCount:d,numVideos:u,numViews:p,joinDate:g,originCountry:m,subscription:S.subscription,subscribeButton:S.button}}ensureScheme(e){return e&&(e.startsWith("http://")||e.startsWith("https://"))?e:`https://${e}`}toUrlObject(e){try{return new URL(this.ensureScheme(e))}catch(e){return null}}extractChannelLinks(e){const t=[];for(const r of e){const e=r?.channelExternalLinkViewModel?.link?.content,o=this.toUrlObject(e),i=r?.channelExternalLinkViewModel?.title?.content,a=r?.channelExternalLinkViewModel?.favicon?.sources,l=a&&Array.isArray(a)?this.largestImageUrlOf(a):"";if(!e||!l||!o)continue;const c=o.hostname.toLowerCase(),[h,d]=this.findTypeForKnownPlatform(c);var n=ge.Other,s=be.Guess;h!==ge.Other||d>be.Guess?(n=h,s=d):[n,s]=this.findTypeByTitle(i),t.push({name:i,type:n,confidence:s,url:this.ensureScheme(e),image:this.ensureScheme(l)})}return t}findTypeForKnownPlatform(e){let t=ge.Other,n=be.Guess;for(const t of Se)if(e.endsWith(t.domain))return[t.type,be.DomainMatch];return[t,n]}findTypeByTitle(e){const t=e.toLowerCase();for(const e of Se){const n=e.domain.split(".");if(n.length<2)continue;const s=n[n.length-2].toLowerCase();if("x.com"!=`${s}.${n[n.length-1].toLowerCase()}`&&t.includes(s))return[e.type,be.TitleMatch]}return[ge.Other,be.Guess]}largestImageUrlOf(e){var t=0,n=null;for(const s of e)if(s.url&&s.width&&s.height){const e=s.width*s.height;e>t&&(t=e,n=s.url)}return n}}n(7752),n(4538),n(5349);var we=n(3358),Ce=n(7268),Te=n(7796),Ee=n(4633),Me=n(6540),Ie=n(5338),Oe=n(1323);const Ae={jsxRootElement:null,jsxRootLoaded:!1};class Ne{static modalButtonId(e){return`${e}-modal-button`}static transcriptButtonId(e){return`${e}-transcript-button`}static watchNextOverlaysButtonId(e){return`${e}-watch-next-overlays-button`}static jsxRootId(e,t){return`${e}-jsx-root-${t}`}}class je{static modalButtonExists(e){return null!==document.getElementById(Ne.modalButtonId(e))}static transcriptButtonExists(e){return null!==je.getTranscriptButton(e)}static watchNextOverlaysButtonExists(e){return null!==document.getElementById(Ne.watchNextOverlaysButtonId(e))}static getTranscriptButton(e){return document.getElementById(Ne.transcriptButtonId(e))}}function Re(){const e=window.getComputedStyle(document.documentElement).fontSize;if(/^\d+px$/.test(e)){return 16/parseInt(e.replace("px",""),10)}return 1.5}const Pe=({jsxContentStore:e})=>{const t=(0,we.a)({scale:Re()}),n=(0,Ee.U)(),[r,o]=(0,Me.useState)(n);(0,Me.useEffect)((()=>{o(n)}),[n]);let i=e((e=>e.jsxRootElement));return null===i&&(i=(0,s.jsx)(s.Fragment,{}),e.setState({jsxRootElement:i})),(0,Me.useEffect)((()=>{e.setState({jsxRootLoaded:!0})}),[]),(0,s.jsxs)(Me.StrictMode,{children:[(0,s.jsx)(Ce.c,{}),(0,s.jsx)(Te.y,{theme:t,forceColorScheme:r,children:i})]})};class Be{prefs;extensionInstanceId;className;reactRoot;rootDiv;rootAppender;jsxContentStore;constructor(e,t,n){this.prefs=e,this.prefs,this.extensionInstanceId=t,this.className=n,this.reactRoot=null,this.rootDiv=null,this.rootAppender=e=>document.body.appendChild(e),this.jsxContentStore=(0,Oe.v)((e=>({...Ae,setJsxRootElement:t=>e({jsxRootElement:t}),setJsxRootLoaded:t=>e({jsxRootLoaded:t})})))}updatePrefs(e){this.prefs=e}isRootCreated(){return null!==this.reactRoot}isJsxRootLoaded(){return this.jsxContentStore.getState().jsxRootLoaded}setRootAppender(e){this.rootAppender=e}createJsxRoot(){this.removeExistingRoots();const e=document.createElement("div");e.id=Ne.jsxRootId(this.extensionInstanceId,this.className),e.className=this.className,this.rootAppender(e);return[e,(0,Ie.H)(e)]}removeExistingRoots(){const e=document.querySelectorAll(`.${this.className}`);e&&e.forEach((e=>{this.prefs.logger.debug(`Removing existing JSX root with id=${e.id} and class=${e.className}`),e.remove()}))}async installReceiver(){return[this.rootDiv,this.reactRoot]=this.createJsxRoot(),this.reactRoot.render((0,s.jsx)(Pe,{jsxContentStore:this.jsxContentStore})),new Promise(((e,t)=>{const n={value:0},s=setInterval((()=>{n.value++,this.isJsxRootLoaded()&&(clearInterval(s),e(!0)),n.value>50&&(clearInterval(s),t(new Error("Failed to expose setJsxRoot()")))}),100)}))}async render(e){this.isRootCreated()&&this.cleanupRoot(),await this.installReceiver();const t=this.jsxContentStore.getState().setJsxRootElement;if(t)try{t(e)}catch(e){}}cleanupRoot(){this.reactRoot&&this.reactRoot.unmount(),this.rootDiv&&this.rootDiv.remove(),[this.reactRoot,this.rootDiv]=[null,null],this.jsxContentStore.setState({jsxRootLoaded:!1,jsxRootElement:null})}}var Ve=n(6942),Le=n.n(Ve),Fe=n(3489),_e=n(5155),De=n(4759),Ue=n(9277),We=n(559),ze=n(5311),He=n(9019),$e=n(7826),Je=n(4999),qe=n(3305),Xe=n(2659),Ke=n(5055),Ge=n(1074),Ye=n(2204),Ze=n(6695),Qe=n(5615),et=n(2964),tt=n(550),nt=n(7380),st=n(1288),rt=n(2152),ot=n(4284),it=n(6195),at=n(2643),lt=n(8247),ct=n(1834),ht=n(6333),dt=n(9301),ut=n(8365),pt=n(5903),mt=n(6193),gt=n(5072),ft=n.n(gt),bt=n(7825),vt=n.n(bt),xt=n(7659),St=n.n(xt),yt=n(5056),kt=n.n(yt),wt=n(540),Ct=n.n(wt),Tt=n(1113),Et=n.n(Tt),Mt=n(2171),It={};It.styleTagTransform=Et(),It.setAttributes=kt(),It.insert=St().bind(null,"head"),It.domAPI=vt(),It.insertStyleElement=Ct();ft()(Mt.Ay,It);Mt.Ay&&Mt.Ay.locals&&Mt.Ay.locals;const Ot={modalWidth:630,avatarWidth:Math.round(127.5),marginBetweenLinks:"10px"},At=()=>{const e=e=>Array.from({length:e},((e,t)=>t));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(_e.x,{gutter:"xs",style:{marginBottom:"-15px"},children:[(0,s.jsx)(_e.x.Col,{span:3,children:(0,s.jsx)(De.E,{height:Ot.avatarWidth,circle:!0,mb:"xl"})}),(0,s.jsxs)(_e.x.Col,{span:9,children:[(0,s.jsx)(De.E,{style:{marginBottom:"16px"},height:32,mt:6,width:"50%",radius:"xl"}),e(3).map((e=>(0,s.jsx)(De.E,{height:18,mt:6,width:"90%",radius:"xl"},e)))]})]}),e(6).map((e=>(0,s.jsx)(Ue.r,{cols:1,children:(0,s.jsx)(De.E,{height:16,mt:6,width:"100%",radius:"xl"})},e))),(0,s.jsx)("div",{className:Mt.$M}),e(4).map((e=>(0,s.jsx)(Ue.r,{cols:1,children:(0,s.jsx)(De.E,{height:16,mt:6,width:"60%",radius:"xl"})},e))),(0,s.jsx)("div",{className:Mt.VB})]})};function Nt(e){return e.generalBoolOptions.openLinksInNewTab.enabled?"_blank":"_self"}const jt=({prefs:e,channelMetadataHolder:t,onChannelInfoClose:n})=>{const[r,{close:o}]=(0,Fe.j)(!0,{onClose:()=>{n()}}),[i,a]=(0,Me.useState)(!0),l=(0,Me.useRef)(!0),[c,h]=(0,Me.useState)(null);(0,Me.useEffect)((()=>{const e=setInterval((()=>{l.current&&null!==t.value&&(h(t.value),l.current=!1)}),100);return()=>clearInterval(e)}),[t]);const d=c?.channelUrl,u=d?.replace(/^https?:\/\/.+youtube\.com\//,"").replace(/^\/+/,""),p=`https://youtube.com/${u}`,m=c?.joinDate?.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})??null,g=c?.subscription===fe.NotSubscribed&&!i||c?.subscription===fe.Subscribed,f=e=>Math.round(e),b=(0,Me.useRef)(null);!function(e,t,n=40){(0,Me.useEffect)((()=>{const s=(r=0)=>{const o=e.current;o?t(o):r<n&&setTimeout((()=>s(r+1)),50)};s()}),[])}(b,(e=>{const t=e.scrollHeight>e.clientHeight;e.classList.toggle("has-overflow",t)}));const v=(e,t,n)=>e>1?n:t,x=Math.max(c?.subsCount||0,0),S=c?.numVideos||0,y=c?.numViews||0;return(0,s.jsxs)(We.a,{size:`${Ot.modalWidth}px`,opened:r,onClose:o,title:"Channel information",className:Mt.vF,radius:"lg",zIndex:1e4,closeOnClickOutside:!0,closeOnEscape:!0,children:[l.current&&(0,s.jsx)(At,{}),!l.current&&(0,s.jsxs)(_e.x,{gutter:"xs",children:[(0,s.jsx)(_e.x.Col,{span:3,children:(0,s.jsx)(ze.e,{size:Ot.avatarWidth,src:c?.avatarUrl})}),(0,s.jsx)(_e.x.Col,{span:9,children:(0,s.jsxs)(He.B,{className:Mt.q6,align:"flex-start",justify:"flex-start",gap:"xs",children:[(0,s.jsx)($e.E,{className:Mt.PZ,size:"xl",style:{marginTop:"10px"},children:(0,s.jsx)("abbr",{style:{textDecoration:"none"},title:c?.name,children:c?.name})}),(0,s.jsxs)(Je.Y,{gap:"sm",children:[(0,s.jsxs)(He.B,{className:Mt.wF,align:"flex-start",justify:"flex-end",gap:"xs",children:[(0,s.jsxs)($e.E,{size:"md",className:Mt.nf,children:[(0,s.jsx)("b",{children:"Subscribers: "}),g?(0,s.jsx)("abbr",{title:"Including you!",style:{textDecoration:"none"},children:(0,s.jsx)(qe.K,{value:f(x),thousandSeparator:!0})}):(0,s.jsx)(qe.K,{value:f(x),thousandSeparator:!0}),(0,s.jsx)(Ut,{count:x})]}),S>0&&(0,s.jsxs)($e.E,{size:"md",className:Mt.nf,children:[(0,s.jsx)("b",{children:"Published: "}),(0,s.jsxs)("a",{href:`${p}/videos`,target:Nt(e),rel:"nofollow",children:[(0,s.jsx)(qe.K,{value:f(S),thousandSeparator:!0})," ",v(S,"video","videos")]})]}),y>0&&(0,s.jsxs)($e.E,{size:"md",className:`${Mt.nf} ${Mt.$p}`,children:[(0,s.jsx)("b",{children:"Total: "}),(0,s.jsx)(qe.K,{value:f(y),thousandSeparator:!0})," ",v(y,"view","views")]})]}),(0,s.jsxs)(Xe.m,{px:0,className:Mt.Im,children:[c?.subscription===fe.NotSubscribed&&i&&(0,s.jsx)("div",{className:"rainbow",children:(0,s.jsx)(Ke.$,{className:"modal-subscribe",color:"black",variant:"filled",radius:"xl",onClick:()=>(a(!1),void c?.subscribeButton?.click()),children:"SUBSCRIBE"})}),g&&(0,s.jsx)(Ke.$,{color:"gray",variant:"filled",radius:"xl",disabled:!0,children:"SUBSCRIBED"}),c?.subscription===fe.Unknown&&(0,s.jsx)($e.E,{w:"100px",size:"sm",children:" "})]})]})]})})]}),!l.current&&(0,s.jsxs)(s.Fragment,{children:[c?.description&&(0,s.jsx)(Ue.r,{cols:1,children:(0,s.jsxs)("div",{className:Le()(Mt.Um,"custom-scrollbar"),ref:b,children:[(0,s.jsx)("b",{children:"About:"})," ",Bt(c?.description??"(no description available)",Nt(e))]})}),m&&(0,s.jsx)(Ue.r,{cols:1,children:(0,s.jsx)(mt.sN,{outerClassName:Le()("withIcon",Mt.OM),icon:(0,s.jsx)(Ye.A,{style:mt.zX,stroke:mt.sr}),outerStyle:{marginTop:"0px",marginBottom:Ot.marginBetweenLinks},text:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("b",{children:"Joined on: "}),(0,s.jsx)("span",{className:Mt.F5,children:m})]})})}),c?.originCountry&&(0,s.jsx)(Ue.r,{cols:1,children:(0,s.jsx)(mt.sN,{outerClassName:Le()("withIcon",Mt.OM),icon:(0,s.jsx)(Ze.A,{style:mt.zX,stroke:mt.sr}),outerStyle:{marginTop:"0px",marginBottom:Ot.marginBetweenLinks},text:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("b",{children:"Country: "}),(0,s.jsx)("span",{className:Mt.F5,children:c.originCountry})]})})}),(0,s.jsxs)(Ue.r,{cols:1,verticalSpacing:0,className:`linksSec ${Mt.Re}`,children:[""!==d&&(0,s.jsx)(mt.sN,{outerClassName:Le()("withIcon",Mt.OM),icon:(0,s.jsx)(Qe.A,{style:mt.zX,stroke:mt.sr}),outerStyle:{marginTop:"0px",marginBottom:Ot.marginBetweenLinks},text:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("b",{children:"Channel page: "}),(0,s.jsx)("a",{rel:"nofollow",href:p,target:Nt(e),children:u})]})}),c?.links.filter((e=>e.url&&""!==e.url.trim())).map(((t,n)=>(0,s.jsx)(Lt,{link:t,prefs:e},n)))]})]})]})};function Rt(e){try{return new URL(e),!0}catch(e){return!1}}function Pt(e){const t=e.split("@");return 2===t.length&&t[0].length>0&&t[1].length>0&&t[1].includes(".")}function Bt(e,t){const n=/(https?:\/\/[^\s().]+(?:\.[^\s(),.]+)*)/g,r=/((?:(?:[^<>()[\]\\.,;:\s@"]+(?:\.[^<>()[\]\\.,;:\s@"]+)*)|.(?:".+"))@(?:(?:\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(?:(?:[a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,})))/g;if(!e.match(n)&&!e.match(r))return e;const o=(e,n,r)=>(0,s.jsx)("a",{href:`${e.hrefPrefix}${n}`,target:t,rel:"noopener noreferrer",children:n},`link-${r}`),i=[{regex:n,hrefPrefix:"",isValid:Rt,transform:o},{regex:r,hrefPrefix:"mailto:",isValid:Pt,transform:o},{regex:/(\n+)/g,transform:(e,t,n)=>t.length>1?(0,s.jsx)("span",{className:Mt.fK,children:" "},`br-${n}`):(0,s.jsx)("br",{},`br-${n}`),isValid:()=>!0}];let a=[e];for(const e of i){const t=[];for(const n of a){const s=n.split(e.regex);t.push(...s)}a=t}return a.map(((e,t)=>{for(const n of i)if(n.regex.test(e)&&n.isValid(e))return n.transform(n,e,t);return e}))}function Vt(e){return(0,s.jsx)(Ge._,{radius:"xs",h:22,w:22,src:e.image,className:Mt.tt})}const Lt=({link:e,prefs:t})=>{const n=e.name,r=e.url.replace(/^https?:\/\//,""),o=function(e){switch(e.type){case ge.Website:return""!==e.image?Vt(e):(0,s.jsx)(et.A,{style:mt.zX,stroke:mt.sr});case ge.Blogspot:return(0,s.jsx)(tt.A,{style:mt.zX,stroke:mt.sr});case ge.Cameo:return(0,s.jsx)(nt.A,{style:mt.zX,stroke:mt.sr});case ge.Discord:return(0,s.jsx)(st.A,{style:mt.zX,stroke:mt.sr});case ge.Facebook:return(0,s.jsx)(rt.A,{style:mt.zX,stroke:mt.sr});case ge.Instagram:return(0,s.jsx)(ot.A,{style:mt.zX,stroke:mt.sr});case ge.Patreon:return(0,s.jsx)(it.A,{style:mt.zX,stroke:mt.sr});case ge.Substack:return(0,s.jsx)(at.A,{style:mt.zX,stroke:mt.sr});case ge.Threads:return(0,s.jsx)(lt.A,{style:mt.zX,stroke:mt.sr});case ge.Tiktok:return(0,s.jsx)(ct.A,{style:mt.zX,stroke:mt.sr});case ge.Twitter:return(0,s.jsx)(ht.A,{style:mt.zX,stroke:mt.sr});case ge.Wordpress:return(0,s.jsx)(dt.A,{style:mt.zX,stroke:mt.sr});default:return""!==e.image?Vt(e):(0,s.jsx)(ut.A,{style:mt.zX,stroke:mt.sr})}}(e);return(0,s.jsx)(mt.sN,{outerClassName:`withIcon ${Mt.OM}`,icon:o,outerStyle:{marginTop:"0px",marginBottom:Ot.marginBetweenLinks},text:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("b",{children:[n,": "]}),(0,s.jsx)("a",{className:Mt.L2,rel:"nofollow",href:e.url,target:Nt(t),children:r})]})})};var Ft;!function(e){e.Silver="#b4b4b4",e.Gold="#ffd700",e.Diamond="#c0c0c0"}(Ft||(Ft={}));class _t{static SILVER={color:Ft.Silver,name:"Silver"};static GOLD={color:Ft.Gold,name:"Gold"};static DIAMOND={color:Ft.Diamond,name:"Diamond",className:`${Mt.lU} ${Mt.Sv}`}}const Dt=({color:e,name:t,className:n})=>(0,s.jsx)("span",{style:{position:"relative",top:"5px",left:"5px",padding:"0px"},children:(0,s.jsx)("abbr",{style:{textDecoration:"none"},title:`${t} play button`,children:(0,s.jsx)(pt.A,{style:{color:e},...n?{className:n}:{}})})}),Ut=({count:e})=>(0,s.jsxs)(s.Fragment,{children:[e>=1e5&&e<1e6&&(0,s.jsx)(Dt,{..._t.SILVER}),e>=1e6&&e<1e7&&(0,s.jsx)(Dt,{..._t.GOLD}),e>=1e7&&(0,s.jsx)(Dt,{..._t.DIAMOND})]}),Wt=(0,Oe.v)()((e=>({prefs:ee.create(),setPrefs:t=>e({prefs:t}),watchNextOverlaysVisible:!1,setWatchNextOverlaysVisible:t=>e({watchNextOverlaysVisible:t}),channelModalActive:!1,setChannelModalActive:t=>e({channelModalActive:t})}))),zt=[".ytp-ce-video.ytp-ce-large-round",".ytp-ce-playlist.ytp-ce-large-round",".ytp-ce-large-round .ytp-ce-expanding-overlay-background",".ytp-ce-video.ytp-ce-medium-round",".ytp-ce-playlist.ytp-ce-medium-round",".ytp-ce-medium-round .ytp-ce-expanding-overlay-background",".ytp-ce-video.ytp-ce-small-round",".ytp-ce-playlist.ytp-ce-small-round",".ytp-ce-small-round .ytp-ce-expanding-overlay-background",".ytp-ce-element.ytp-ce-channel",".ytp-ce-element.ytp-ce-website",".ytp-ce-element.ytp-ce-merchandise"].join(", "),Ht={display:["none","!important"],visibility:"hidden",width:"0px",height:"0px",opacity:"0"},$t=(Object.entries(Ht).map((([e,t])=>Array.isArray(t)?`${e}: ${t.join(" ")};`:`${e}: ${t};`)).join(" "),"custom-hiding-id");const Jt="controls-for-youtube-progress-indicator",qt=".ytp-play-progress";const Xt={elementType:"watchNextOverlays",prefsOption:e=>e.generalBoolOptions.removeWatchNextOverlays.enabled,selector:zt},Kt=[{elementType:"skip5SecIndicators",prefsOption:e=>e.generalBoolOptions.skip5SecOverlays.enabled,selector:"div.ytp-doubletap-ui, div.ytp-doubletap-ui-legacy"},Xt];class Gt{prefs;extensionInstanceId;periodicMonitor=null;manualRemoveWatchNextOverlays=null;constructor(e,t){this.prefs=e,this.extensionInstanceId=t}updatePrefs(e){const t={...this.prefs};this.prefs=e,this.maybeResetManualOverride(t),this.applyOrRemoveIdsAsPerPrefs(t),this.applyOrRemoveClassForProgressIndicator(t)}maybeResetManualOverride(e){const t=e.generalBoolOptions.removeWatchNextOverlays.enabled,n=this.prefs.generalBoolOptions.removeWatchNextOverlays.enabled;t!==n&&null!==this.manualRemoveWatchNextOverlays&&n!==this.manualRemoveWatchNextOverlays&&(this.manualRemoveWatchNextOverlays=null,Wt.setState({watchNextOverlaysVisible:!this.prefs.generalBoolOptions.removeWatchNextOverlays.enabled}))}overrideRemoveWatchNextOverlays(e){this.manualRemoveWatchNextOverlays=e,this.addOrRemoveIdForElementType(this.maybeOverrideConfig(Xt))}maybeOverrideConfig(e){const t=this.manualRemoveWatchNextOverlays;return"watchNextOverlays"===e.elementType&&null!==t?{...e,prefsOption:e=>t}:e}applyOrRemoveIdsAsPerPrefs(e){if(!E()||je.watchNextOverlaysButtonExists(this.extensionInstanceId)){for(const t of Kt)this.addOrRemoveIdForElementType(this.maybeOverrideConfig(t),e);this.applyOrRemoveClassForProgressIndicator(e)}}addOrRemoveIdForElementType(e,t){const n=e.prefsOption(this.prefs),s=t&&e.prefsOption(t),r=!!t;t&&s===n||this.checkForNonConformingElementsForConfig(e,r)}checkForNonConformingElementsForConfig(e,t){const n=this.detectElements(e.selector),s=e.prefsOption(this.prefs);s&&n.visibleElements.length>0||!s&&n.hiddenElements.length>0?(this.logMatchMismatch(!1,t,e.elementType,s,n),this.correctMismatch(e,s,n)):t&&this.logMatchMismatch(!0,t,e.elementType,s,n)}initialize(){this.injectCustomHidingStyles(),this.applyOrRemoveIdsAsPerPrefs()}onVideoIdChange(){this.injectCustomHidingStyles(),this.applyOrRemoveIdsAsPerPrefs()}injectCustomHidingStyles(e=1){const t=f.CSS_INJECT_COMMON_STYLES;chrome.runtime.sendMessage({type:t},(t=>{t||e<10&&setTimeout((()=>this.injectCustomHidingStyles(e+1)),1e3)}))}applyOrRemoveClassForProgressIndicator(e){const t=this.prefs.generalBoolOptions.removeProgressGradient.enabled,n=e&&e.generalBoolOptions.removeProgressGradient.enabled;e&&n===t||this.addOrRemoveClassForProgressIndicator(t)}addOrRemoveClassForProgressIndicator(e){const t=Array.from(document.querySelectorAll(qt));e?t.forEach((e=>e.classList.add(Jt))):t.forEach((e=>e.classList.remove(Jt)))}printDebugInfo(){for(const e of Kt){const t=this.detectElements(e.selector),n=e.prefsOption(this.prefs),s=n&&t.visibleElements.length>0||!n&&t.hiddenElements.length>0;this.logMatchMismatch(!s,!0,e.elementType,n,t)}}correctAnyMismatches(){for(const e of Kt){const t=this.detectElements(e.selector),n=e.prefsOption(this.prefs);(n&&t.visibleElements.length>0||!n&&t.hiddenElements.length>0)&&this.correctMismatch(e,n,t)}}correctMismatch(e,t,n){t&&n.visibleElements.length>0?n.visibleElements.forEach((e=>this.addElementId(e,$t))):!t&&n.hiddenElements.length>0&&n.hiddenElements.forEach((e=>this.removeElementId(e,$t)))}addElementId(e,t){(e.id||"").includes(t)||(e.id=t)}removeElementId(e,t){e.id&&e.id.includes(t)&&(e.id="")}logMatchMismatch(e,t,n,s,r){}detectElements(e){const t=Array.from(document.querySelectorAll(e));return this.partitionElements(t)}partitionElements(e){const t=this.elementsNotHiddenByCss(e),n=e.filter((e=>!t.includes(e)));return{visibleElements:t,hiddenElements:n,allElements:e}}elementsNotHiddenByCss(e){return e.filter((e=>{if(e.id&&e.id===$t)return!1;const t=window.getComputedStyle(e);let n=!1;for(const[e,s]of Object.entries(Ht)){const r=Array.isArray(s)?s[0]:s;if(t.getPropertyValue(e)!==r){n=!0;break}}return n}))}startMonitoring(){this.periodicMonitor=setInterval((()=>{this.applyOrRemoveIdsAsPerPrefs()}),o)}stopMonitoring(){this.periodicMonitor&&(clearInterval(this.periodicMonitor),this.periodicMonitor=null)}}var Yt=n(2970);const Zt=[["ab","Abkhazian"],["aa","Afar"],["af","Afrikaans"],["ak","Akan"],["sq","Albanian"],["am","Amharic"],["ar","Arabic"],["arc","Aramaic"],["hy","Armenian"],["as","Assamese"],["ay","Aymara"],["az","Azerbaijani"],["bn","Bangla"],["ba","Bashkir"],["eu","Basque"],["be","Belarusian"],["bho","Bhojpuri"],["bi","Bislama"],["bs","Bosnian"],["br","Breton"],["bg","Bulgarian"],["bg-BG","Bulgarian (Bulgaria)"],["my","Burmese"],["yue","Cantonese"],["yue-HK","Cantonese (Hong Kong)"],["ca","Catalan"],["ceb","Cebuano"],["ckb","Central Kurdish"],["chr","Cherokee"],["zh","Chinese"],["zh-CN","Chinese (China)"],["zh-HK","Chinese (Hong Kong)"],["zh-Hans","Chinese (Simplified)"],["zh-SG","Chinese (Singapore)"],["zh-TW","Chinese (Taiwan)"],["zh-Hant","Chinese (Traditional)"],["cho","Choctaw"],["co","Corsican"],["hr","Croatian"],["cs","Czech"],["da","Danish"],["dv","Divehi"],["nl","Dutch"],["nl-BE","Dutch (Belgium)"],["nl-NL","Dutch (Netherlands)"],["dz","Dzongkha"],["en","English"],["en-CA","English (Canada)"],["en-IE","English (Ireland)"],["en-GB","English (United Kingdom)"],["en-US","English (United States)"],["eo","Esperanto"],["et","Estonian"],["ee","Ewe"],["fo","Faroese"],["fj","Fijian"],["fil","Filipino"],["fi","Finnish"],["fr","French"],["fr-BE","French (Belgium)"],["fr-CA","French (Canada)"],["fr-FR","French (France)"],["fr-CH","French (Switzerland)"],["ff","Fulah"],["gl","Galician"],["lg","Ganda"],["ka","Georgian"],["de","German"],["de-AT","German (Austria)"],["de-DE","German (Germany)"],["de-CH","German (Switzerland)"],["el","Greek"],["gn","Guarani"],["gu","Gujarati"],["ht","Haitian Creole"],["hak","Hakka Chinese"],["hak-TW","Hakka Chinese (Taiwan)"],["ha","Hausa"],["haw","Hawaiian"],["iw","Hebrew"],["hi","Hindi"],["hi-Latn","Hindi (Latin)"],["hmn","Hmong"],["hu","Hungarian"],["is","Icelandic"],["ig","Igbo"],["id","Indonesian"],["iu","Inuktitut"],["ik","Inupiaq"],["ga","Irish"],["it","Italian"],["ja","Japanese"],["jv","Javanese"],["kl","Kalaallisut"],["kn","Kannada"],["ks","Kashmiri"],["kk","Kazakh"],["km","Khmer"],["rw","Kinyarwanda"],["tlh","Klingon"],["ko","Korean"],["kri","Krio"],["ku","Kurdish"],["ky","Kyrgyz"],["lo","Lao"],["la","Latin"],["lv","Latvian"],["li","Limburgish"],["ln","Lingala"],["lt","Lithuanian"],["lb","Luxembourgish"],["mk","Macedonian"],["mg","Malagasy"],["ms","Malay"],["ml","Malayalam"],["mt","Maltese"],["mni","Manipuri"],["mi","Māori"],["mr","Marathi"],["mas","Masai"],["nan","Min Nan Chinese"],["nan-TW","Min Nan Chinese (Taiwan)"],["lus","Mizo"],["mn","Mongolian"],["na","Nauru"],["nv","Navajo"],["ne","Nepali"],["nso","Northern Sotho"],["no","Norwegian"],["ny","Nyanja"],["oc","Occitan"],["or","Odia"],["om","Oromo"],["ps","Pashto"],["fa","Persian"],["fa-AF","Persian (Afghanistan)"],["fa-IR","Persian (Iran)"],["pl","Polish"],["pt","Portuguese"],["pt-BR","Portuguese (Brazil)"],["pt-PT","Portuguese (Portugal)"],["pa","Punjabi"],["qu","Quechua"],["ro","Romanian"],["ro-MD","Romanian (Moldova)"],["rm","Romansh"],["rn","Rundi"],["ru","Russian"],["ru-Latn","Russian (Latin)"],["sm","Samoan"],["sg","Sango"],["sa","Sanskrit"],["sc","Sardinian"],["gd","Scottish Gaelic"],["sr","Serbian"],["sr-Cyrl","Serbian (Cyrillic)"],["sr-Latn","Serbian (Latin)"],["sdp","Sherdukpen"],["sn","Shona"],["scn","Sicilian"],["sd","Sindhi"],["si","Sinhala"],["sk","Slovak"],["sl","Slovenian"],["so","Somali"],["st","Southern Sotho"],["es","Spanish"],["es-419","Spanish (Latin America)"],["es-MX","Spanish (Mexico)"],["es-ES","Spanish (Spain)"],["es-US","Spanish (United States)"],["su","Sundanese"],["sw","Swahili"],["ss","Swati"],["sv","Swedish"],["tl","Tagalog"],["tg","Tajik"],["ta","Tamil"],["tt","Tatar"],["te","Telugu"],["th","Thai"],["bo","Tibetan"],["ti","Tigrinya"],["to","Tongan"],["ts","Tsonga"],["tn","Tswana"],["tr","Turkish"],["tk","Turkmen"],["uk","Ukrainian"],["ur","Urdu"],["ug","Uyghur"],["uz","Uzbek"],["vi","Vietnamese"],["vo","Volapük"],["cy","Welsh"],["fy","Western Frisian"],["wo","Wolof"],["xh","Xhosa"],["yi","Yiddish"],["yo","Yoruba"],["zu","Zulu"]],Qt=["ar","arc","ckb","dv","fa","ku","iw","ps","sd","ur","yi"],en="asr";const tn={quot:'"',apos:"'",lt:"<",gt:">",amp:"&",nbsp:" ",ldquo:"“",rdquo:"”",lsquo:"‘",rsquo:"’",ndash:"–",mdash:"—",hellip:"…",vellip:"⋮",trade:"™",reg:"®",copy:"©",times:"×",divide:"÷",plusmn:"±",sup2:"²",sup3:"³",deg:"°",le:"≤",ge:"≥",ne:"≠",asymp:"≈",pi:"π",infin:"∞",approx:"≈",not:"¬",sum:"∑",prod:"∏",int:"∫",euro:"€",pound:"£",dollar:"$",cent:"¢",yen:"¥",circ:"ˆ",tilde:"~",macr:"¯",breve:"˘",ring:"˚",ogon:"˛",caron:"ˇ"};function nn(e,t,n){return`ts_${e}_${t}_${n}`}function sn(e){return{sections:e.sections.map((e=>({...e,text:rn(e.text)}))),preserveUltraShort:e.preserveUltraShort}}function rn(e){const t=["font","b","i","u","s","sup","sub","span"],n=t.map((e=>t=>function(e,t){let n=e,s="";const r=new RegExp(`<${t}[^>]*>(.*?)</${t}>`,"g");for(;n!==s;)s=n,n=n.replace(r,((e,t)=>t));return n}(t,e))),s=t.map((e=>t=>function(e,t){const n=new RegExp(`<${t}[^>]*>[\\r\\n ]*</${t}>`,"g");return e.replace(n,"")}(t,e))),r=[on,an,...n,...s];return(0,Yt.combineFunctions)(e,...r)}function on(e){return e.replaceAll(/\u200B/g,"").replaceAll(/\xe2\x80\x8B/g,"").replaceAll(/\u200C/g,"").replaceAll(/\u200D/g,"")}function an(e){return e.replace(/&([#a-zA-Z0-9]+);/g,((e,t)=>{if(tn[t])return tn[t];if(t.startsWith("#x")){const e=t.slice(2);if(/^[\dA-Fa-f]+$/.test(e))return String.fromCharCode(parseInt(e,16))}if(t.startsWith("#")){const e=t.slice(1);if(/^\d+$/.test(e))return String.fromCharCode(parseInt(e,10))}return e}))}function ln(e,t=!0){const n=[];return e.sections.forEach((e=>{const s=(t?e.text.replaceAll(/\n/g," "):e.text).replaceAll(/[  \t\v\f]+/g," ").trim();s.length>0&&n.push({...e,text:s})})),{sections:n,preserveUltraShort:e.preserveUltraShort}}function cn(e,t,n,s){const r=function(e,t){const{maxTimeSec:n,minChars:s,maxChars:r,absoluteMaxChars:o,preferSentenceBoundary:i}=t;if(0===e.sections.length)return{groups:[],rtl:!1};const a=[];let l=[],c="",h=e.sections[0].start;const d=()=>{if(0===l.length)return;const e=l[0],t=l[l.length-1],n=e.start,s=t.start+t.duration-n;a.push({start:n,duration:s,sections:l,sectionIndex:-1}),l=[],c=""},u=e=>{const t=e.trim();if(!t)return!1;const n=t.charAt(t.length-1),s=t.length>1?t.charAt(t.length-2):"",r=[".","?","!"],o=['"',"”"];return r.includes(n)||r.includes(s)&&o.includes(n)},p=i?o:r;for(const t of e.sections){const e=c+t.text,r=e.length,o=0===l.length?t.start:h;(t.start+t.duration-o>n||r>p)&&c.length>=s?(d(),l.push(t),c=t.text,h=t.start):(l.push(t),c=e,h=o,i&&c.length>=s&&u(c)&&d())}l.length>0&&d();let m=0;for(let e=0;e<a.length;e++)a[e].sectionIndex=m,m+=a[e].sections.length;return{groups:a,rtl:!1}}(hn(n,t,e),c[s]);return r.rtl=function(e){const t=gn(e);return null!==t&&Qt.includes(t)}(t),r}function hn(e,t,n){const s=[bn,fn,bn,sn,vn,xn,ln],r=function(e,t,n){const s=[];for(let r=0;r<n.sections.length;r++){const o=n.sections[r],i=nn(e,t,r);s.push({...o,id:i})}return{sections:s,preserveUltraShort:n.preserveUltraShort}}(n,t,e);return(0,Yt.combineFunctions)(r,...s)}function dn(e,t){return cn("(videoId)","(languageVssId)",e,t).groups.map((e=>e.sections.map((e=>e.text)).join(" "))).join("\n").replaceAll(/ +\n/g,"\n").replaceAll(/\n +/g,"\n").replaceAll(/\n+/g,"\n").replaceAll(/ +/g," ")}function un(e,t){const n=e.transcriptOptions.preferredLanguage,s=n.indexOf("-"),r=s>0?n.substring(0,s):n,o=pn(t);if(0===o.length)return null;let i=-1,a=-1,l=-1,c=-1,h=-1;for(let e=0;e<o.length;e++){const t=o[e],d=(t.kind||"")===en||t.vssId.startsWith("a."),u=t.vssId.split(".").length>2,p=t.languageCode.split("-")[0];if(-1===i&&-1!==s&&!d&&t.languageCode===n&&!u){i=e;break}d||p!==r||u||(-1===a||t.languageCode===r)&&(a=e),!d&&p===r&&u&&-1===l&&(l=e),-1===c&&d&&t.languageCode===r&&t.vssId===`a.${r}`&&(c=e),-1!==h||d||(h=e)}return o[[i,a,l,c,h].find((e=>-1!==e))??0].vssId}function pn(e){return[...Object.values(e.contentsByLanguage).map((e=>({vssId:e.languageVssId,languageCode:e.languageCode,printName:e.languagePrintName,kind:e.kind}))),...e.otherLanguages.map((e=>({vssId:e.vssId,languageCode:e.languageCode,printName:e.name.simpleText,kind:e.kind})))]}const mn=/^(?:a\.([a-z]+))|^\.([^.-]+).*/;function gn(e){const t=mn.exec(e);return t?t[1]??t[2]:null}function fn(e){if(e.sections.length<2)return e;const t=[];for(let n=0;n<e.sections.length-1;n++){const s=e.sections[n],r=e.sections[n+1];s.start+s.duration>r.start&&(s.duration=r.start-s.start),t.push(s)}return t.push(e.sections[e.sections.length-1]),{sections:t,preserveUltraShort:e.preserveUltraShort}}function bn(e){return e.preserveUltraShort?e:{sections:e.sections.filter((e=>e.duration>.2&&!(e.start<1&&e.duration<1)))}}function vn(e){return{sections:e.sections.filter((e=>""!==e.text.trim())),preserveUltraShort:e.preserveUltraShort}}function xn(e){return{sections:e.sections.map(((e,t)=>({...e,id:e.id.replace(/_[0-9]+$/,`_${t}`)}))),preserveUltraShort:e.preserveUltraShort}}var Sn=n(183);const yn={startSection:-1,startOffset:-1,endSection:-1,endOffset:-1};var kn;!function(e){e[e.NONE=0]="NONE",e[e.CROSSED_END=1]="CROSSED_END",e[e.CROSSED_START=2]="CROSSED_START"}(kn||(kn={}));class wn{static notFound(){return{message:"Not found",className:"transcript-search-bar-input-not-found"}}static oneOfSeveral(e,t){return{message:`Result ${e+1} of ${t}`,className:"transcript-search-bar-input-one-of-several"}}}const Cn=!1;class Tn{prefs;sections=[];fullText="";highlightCallback=()=>{};endOfSearchCallback=()=>{};notFoundCallback=()=>{};resetSearchCallback=()=>{};currentSearchTerm="";matches=[];currentMatchIndex=-1;currentVideoTimeSec=0;constructor(e,t){this.prefs=e,this.prefs,this.updateSections(t)}updatePrefs(e){this.prefs=e}onSearchHit(e){this.highlightCallback=e}onEndOfSearch(e){this.endOfSearchCallback=e}onResetSearch(e){this.resetSearchCallback=e}onNotFound(e){this.notFoundCallback=e}updateVideoTimeSec(e){Cn}updateSections(e){this.sections=e,this.fullText=this.sections.map((e=>e.text)).join(" "),this.clearSearch()}clearSearch(){this.currentSearchTerm="",this.matches=[],this.currentMatchIndex=-1,this.resetSearchCallback()}highlightMatch(e){this.highlightCallback(e,this.currentMatchIndex,this.matches.length)}findAllMatches(e){if(!e||!this.fullText)return[];const t=[],n=(0,Sn.asciifyText)(e).toLowerCase(),s=(0,Sn.asciifyText)(this.fullText).toLowerCase();let r=0;for(;;){const e=s.indexOf(n,r);if(-1===e)break;let o=0,i=-1,a=0;for(let t=0;t<this.sections.length;t++){const n=this.sections[t].text.length+1;if(o+n>e){i=t,a=e-o;break}o+=n}if(-1===i)break;const l=e+n.length;let c=i,h=a+n.length;o=0;let d=!1;for(let e=0;e<this.sections.length;e++){const t=this.sections[e].text.length+1;if(o+t>l){c=e,h=l-o-1,d=!0;break}o+=t}if(!d)break;t.push({startSection:i,startOffset:a,endSection:c,endOffset:h}),r=e+n.length}return t}search(e){const t=e.trim();return this.currentSearchTerm=t,this.currentMatchIndex=-1,t?(this.matches=this.findAllMatches(t),this.goToNext()):null}goToNext(){if(!this.currentSearchTerm||0===this.matches.length)return this.notFoundCallback(),null;this.currentMatchIndex++,this.currentMatchIndex>=this.matches.length&&(this.matches.length>0&&this.endOfSearchCallback(kn.CROSSED_END),this.currentMatchIndex=0);const e=this.matches[this.currentMatchIndex];return this.highlightMatch(e),e}goToPrevious(){if(!this.currentSearchTerm||0===this.matches.length)return this.notFoundCallback(),null;this.currentMatchIndex--,this.currentMatchIndex<0&&(this.matches.length>0&&this.endOfSearchCallback(kn.CROSSED_START),this.currentMatchIndex=this.matches.length-1);const e=this.matches[this.currentMatchIndex];return this.highlightMatch(e),e}}var En=n(1398),Mn=n(2335),In=n(5891),On=n(3720),An=n(5773),Nn=n(5076),jn=n(174),Rn=n(8087),Pn=n(2246),Bn=n(8324),Vn=n(7193),Ln=n(355),Fn=n(9230),_n=n(6292),Dn=n(5961),Un=n(899),Wn=n(8672),zn=n(3),Hn=n(2282),$n=n(909),Jn=n(6765),qn=n(6280),Xn=n(8286);const Kn={videoId:"",transcriptOpen:!1,buttonsBarVisible:!1,searchMatch:yn,searchStarted:!1,followingVideo:!0,currentLanguageVssId:null,searchInfoMessage:null},Gn=(0,Oe.v)()((e=>({...Kn,setVideoId:t=>e({videoId:t}),setTranscriptOpen:t=>e({transcriptOpen:t}),setButtonsBarVisible:t=>e({buttonsBarVisible:t}),setSearchMatch:t=>e({searchMatch:t}),setSearchStarted:t=>e({searchStarted:t}),setFollowingVideo:t=>e({followingVideo:t}),setCurrentLanguageVssId:t=>e({currentLanguageVssId:t}),setSearchInfoMessage:t=>e({searchInfoMessage:t})})));var Yn=n(9914);function Zn(){return function(e){const t=[],n=new Map;for(const[t,s]of e){const e=t.split("-")[0],r=n.get(e)??[];r.push({code:t,name:s}),n.set(e,r)}for(const[e,s]of n){const n=(s.find((t=>t.code===e))||s[0]).name.split(" (")[0],r=[];for(const t of s){if(t.code===e)continue;const n=t.code.split("-")[1],s=t.name.match(/\((.*?)\)$/);if(!s)continue;const o=s[1];4===n.length&&n[0]===n[0].toUpperCase()?r.push({script:n,description:o}):r.push({region:n,description:o})}t.push({languageSubTag:e,baseLanguageName:n,variants:r})}t.sort(((e,t)=>e.languageSubTag.localeCompare(t.languageSubTag)));for(const e of t){const t=e.variants.filter((e=>"script"in e)).sort(((e,t)=>e.description.localeCompare(t.description))),n=e.variants.filter((e=>"region"in e)).sort(((e,t)=>e.description.localeCompare(t.description)));e.variants=[...t,...n]}return t}(Array.from(Zt))}const Qn={videoId:"",contentsByLanguage:{},otherLanguages:[]};class es{message;retryFunction;constructor(e,t){this.message=e,this.retryFunction=t}get isRetryable(){return null!==this.retryFunction}static NoneAvailable(){return new es("No transcript found",null)}static RetryableFailure(e){return new es("Error loading transcript",e)}}const ts=({uiActions:e,searchActions:t})=>{const n=Wt((e=>e.prefs)),[r,o]=(0,Me.useState)(null),{videoId:i,currentLanguageVssId:a,setCurrentLanguageVssId:l,setSearchMatch:c}=Gn((0,Yn.k)((e=>({videoId:e.videoId,currentLanguageVssId:e.currentLanguageVssId,setCurrentLanguageVssId:e.setCurrentLanguageVssId,setSearchMatch:e.setSearchMatch})))),[h,d]=(0,Me.useState)(null),[u,p]=(0,Me.useState)(!1),[m,g]=(0,Me.useState)(null),[f,b]=(0,Me.useState)(n.transcriptOptions.defaultBlockSizeIndex),[v,x]=(0,Me.useState)(null),S=(u||null===h||null===v)&&null===m,y=e=>{x(null),g(e)},k=()=>{c(yn),o(null),d(null),x(null),g(null),e.initializeTranscript(i).then((t=>{if(!t)return void y(es.NoneAvailable());o(t);const s=n.transcriptOptions.preferredLanguage,r=a?function(e,t,n){const s=pn(e),r=s.find((e=>e.kind!==en&&e.languageCode===n));if(r)return r;let o=-1;const i=gn(t);for(let e=0;e<s.length;e++){const n=s[e],r=n.languageCode.indexOf("-");if((r>0?n.languageCode.substring(0,r):n.languageCode)===i){const r=-1!==o&&s[o].kind===en,i=n.kind===en;if(i&&-1!==o&&!r)continue;const a=-1!==o&&s[o].vssId===t;if(!r&&!i&&a)continue;o=e}}return-1!==o?s[o]:null}(t,a,s):null,i=r?r.vssId:un(n,t);i?e.getTranscriptContents(t,i).then((e=>{e&&(a!==i&&l(i),d(e))})).catch((e=>{y(es.RetryableFailure((()=>k())))})):y(es.NoneAvailable())})).catch((e=>{y(es.RetryableFailure((()=>k())))}))};(0,Me.useEffect)((()=>{k()}),[i]);const w=()=>{if(c(yn),t.clearSearch(),a&&r){if(a in r.contentsByLanguage){const e=r.contentsByLanguage[a];d(e)}else p(!0),e.getTranscriptContents(r,a).then((e=>{if(p(!1),e){const t=hn(e,a,i);d(t)}else y(es.RetryableFailure((()=>w())))})).catch((e=>{y(es.RetryableFailure((()=>w())))}))}};(0,Me.useEffect)((()=>{n.logger.debug(`[TSI] useEffect(currentLanguageVssId): currentLanguageVssId changed to ${a}`),w()}),[a]);const C=()=>{if(h&&a){const e=cn(i,a,h,f);x(e)}};(0,Me.useEffect)((()=>{null!==h&&e.onTranscriptLanguageChange(h),C()}),[h]),(0,Me.useEffect)((()=>{C()}),[f]),(0,Me.useEffect)((()=>{e.highlightAndJumpToCurrentSection()}),[v]);const T=null===m||m.isRetryable?500:120;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"transcript-outer-container",children:[(0,s.jsx)(rs,{disabled:S||!r,rootTranscript:r||Qn}),(0,s.jsx)("div",{id:"transcript-block",children:(0,s.jsxs)(He.B,{h:T-40,className:"transcript-block-stack",align:"stretch",justify:m?.message?"center":"flex-start",gap:"md",children:[S&&(0,s.jsx)(ls,{height:T}),m&&(0,s.jsx)(ns,{errorCause:m}),v&&v.groups.map((t=>(0,s.jsx)(ds,{rtl:v.rtl,group:t,timeCallback:t=>e.onTimestampClicked(t)},t.start)))]})}),(0,s.jsx)(cs,{isLoading:S,disabled:S||null!==m,searchActions:t}),(0,s.jsx)(is,{transcriptContents:h,rightColActions:e,disabled:S,blockSizeIndex:f,onBlockSizeIndexChange:b})]})})},ns=({errorCause:e})=>{Wt((e=>e.prefs));return(0,s.jsx)("div",{className:"transcript-error",children:(0,s.jsxs)(He.B,{gap:"xs",align:"center",children:[(0,s.jsx)(_n.A,{size:28,stroke:1.2}),(0,s.jsx)("h2",{className:"transcript-error-title",children:e.message}),e.isRetryable&&(0,s.jsx)(Ke.$,{variant:"filled",size:"md",radius:"xl",onClick:()=>e.retryFunction?.(),children:"Try again"})]})})};function ss(e,t){const n=e.name.split(" ")[0],s=t.name.split(" ")[0],r=n.localeCompare(s);return 0!==r?r:e.autoGenerated&&!t.autoGenerated?1:!e.autoGenerated&&t.autoGenerated?-1:e.name.localeCompare(t.name)}const rs=({disabled:e,rootTranscript:t})=>{const n=Wt((e=>e.prefs)),{currentLanguageVssId:r,setCurrentLanguageVssId:o}=Gn((0,Yn.k)((e=>({currentLanguageVssId:e.currentLanguageVssId,setCurrentLanguageVssId:e.setCurrentLanguageVssId})))),i=function(e){return[...Object.values(e.contentsByLanguage).map((e=>({vssId:e.languageVssId,name:e.languagePrintName,autoGenerated:e.kind===en}))),...e.otherLanguages.map((e=>({vssId:e.vssId,name:e.name.simpleText,autoGenerated:e.kind===en})))]}(t).sort(ss).map((e=>({value:e.vssId,label:e.name}))),a=1===i.length,l=(0,s.jsx)(Dn.A,{stroke:2,size:14,color:"currentColor",opacity:.8,style:{marginRight:"-4px"}}),c=(0,s.jsx)(Un.A,{style:{marginInlineStart:"auto"},stroke:1.5,size:18,color:"currentColor",opacity:.6}),h=un(n,t);return(0,s.jsxs)("div",{className:"transcript-language-selector",children:[a&&e&&(0,s.jsx)($e.E,{className:"transcript-language-loading",children:"Loading..."}),a&&!e&&(0,s.jsx)(os,{language:i[0].label}),!a&&!e&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("label",{className:"transcript-language-selector-label",children:"Language:"}),(0,s.jsx)(Rn.l,{label:"",classNames:{root:"transcript-language-selector-select",dropdown:"transcript-language-selector-dropdown"},placeholder:"Select language",data:i,value:r,disabled:e,comboboxProps:mt.VX,renderOption:({option:e,checked:t})=>(0,s.jsxs)(Je.Y,{flex:"1",gap:"xs",children:[e.value===h&&l,e.label,t&&c]}),allowDeselect:!1,onChange:e=>{e&&o(e)}})]})]})},os=({language:e})=>(0,s.jsx)(Mn.m,{label:"No other languages available",withArrow:!0,arrowPosition:"center",arrowSize:10,arrowOffset:0,children:(0,s.jsx)($e.E,{className:"transcript-language-single-label",children:e})});const is=e=>{const{transcriptContents:t,rightColActions:n,disabled:r,blockSizeIndex:o,onBlockSizeIndexChange:i}=e,{currentLanguageVssId:a,videoId:l,followingVideo:h,setFollowingVideo:d}=Gn((0,Yn.k)((e=>({currentLanguageVssId:e.currentLanguageVssId,videoId:e.videoId,followingVideo:e.followingVideo,setFollowingVideo:e.setFollowingVideo})))),u=r||!t,[p,m]=[2,18],g=h?(0,s.jsx)(Wn.A,{size:m,stroke:p}):(0,s.jsx)(zn.A,{size:m,stroke:p}),f=(0,s.jsx)(Hn.A,{size:m,stroke:p}),b=(0,s.jsx)($n.A,{size:m,stroke:p}),[v,x]=(0,Me.useState)(f),S=(0,s.jsxs)(s.Fragment,{children:["Copy the entire video transcript to your clipboard. Or press ",(0,mt.qA)("Shift","xs")," and click to download it as a file."]}),[y,k]=(0,Me.useState)(S),[w,C]=(0,Me.useState)("🎉 Copied!"),[T,E]=(0,Me.useState)(!1);return(0,s.jsx)(He.B,{gap:"sm",children:(0,s.jsxs)(Je.Y,{gap:"sm",justify:"space-between",className:"transcript-buttons-bar",children:[(0,s.jsx)(as,{originalLabel:y,afterClickLabel:w,icon:v,multilineTooltip:!1===T,...!1===T?{tooltipWidth:340}:{},onClick:()=>{if(T&&t){const e=function(){const e=document.querySelector("div#above-the-fold div#title h1")?.textContent;return e?e.trim().replace(/\s+/g," "):null}();!function(e,t){const n=new Blob([t],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(n),r={download:e,href:s};Object.assign(document.createElement("a"),r).click(),URL.revokeObjectURL(s)}(function(e,t,n){const s=e?gn(e):null,r=Zn(),o=s?r.find((e=>e.languageSubTag===s))?.baseLanguageName:null,i=n?function(e){return e.trim().replace(/[?!:"|]/g,"").replace(/[ _-]+/g," ")}(n):null;return o||i?!o&&i?`Transcript - ${i}.txt`:o&&!i?`Transcript (${o}).txt`:`Transcript - ${i} (${o}).txt`:`Transcript - YouTube video ${t}.txt`}(a,l,e),dn(t,o))}else t&&n.copyTranscript(t,o)},onHoverWithShift:e=>{e&&t?(x(b),k("Download this transcript"),C("🎉 Downloading!"),E(!0)):(x(f),k(S),C("🎉 Copied!"),E(!1))},disabled:u}),(0,s.jsx)(as,{originalLabel:"Copy a link to this video, at the current time",afterClickLabel:"🎉 Copied!",icon:(0,s.jsx)(ut.A,{size:m,stroke:p}),onClick:()=>n.copyVideoLink(),disabled:r}),(0,s.jsx)(as,{originalLabel:h?"The transcript follows the video as it plays, highlighting the current section":"The transcript does not follow the video",tooltipWidth:280,afterClickLabel:()=>h?"No longer following!":"Now following the video!",icon:g,color:h?"blue":"gray",variant:h?"filled":"default",onClick:()=>{const e=!h;d(e),n.onFollowModeChange(e)},disabled:u}),(0,s.jsx)(Mn.m,{label:"Adjust the length of the transcript blocks",position:"left",offset:{mainAxis:8,crossAxis:-8},disabled:u,children:(0,s.jsx)(Pn.A,{disabled:u,id:"transcript-block-slider",value:o,onChange:e=>i(e),min:0,max:c.length-1,color:"#606060",thumbSize:14,size:"4",labelAlwaysOn:!1,showLabelOnHover:!1,label:e=>c[e].label,marks:c.map(((e,t)=>({value:t,label:e.tickMark}))),classNames:{mark:"transcript-block-slider-mark",markLabel:"transcript-block-slider-mark-label",thumb:"transcript-block-slider-thumb"}})})]})})},as=({originalLabel:e,afterClickLabel:t,icon:n,onClick:r,onHoverWithShift:o,disabled:i,color:a,variant:l,tooltipWidth:c,multilineTooltip:h})=>{const d=(0,Me.useRef)(e),[u,p]=(0,Me.useState)(d.current),m=(0,Me.useRef)(null);(0,Me.useEffect)((()=>{d.current=e,p(e)}),[e]);const[g,f]=(0,Me.useState)(!1),{hoverProps:b}=function(e){const[t,n]=(0,Me.useState)(!1),[s,r]=(0,Me.useState)(!1);(0,Me.useEffect)((()=>{if(!s)return;const r=s=>{"Shift"!==s.key||t||(n(!0),e(!0))},o=s=>{"Shift"===s.key&&t&&(n(!1),e(!1))};return window.addEventListener("keydown",r),window.addEventListener("keyup",o),()=>{window.removeEventListener("keydown",r),window.removeEventListener("keyup",o)}}),[s,t,e]);const o=(0,Me.useCallback)((s=>{r(!0),s.shiftKey&&!t&&(n(!0),e(!0))}),[e,t]),i=(0,Me.useCallback)((()=>{r(!1),t&&(n(!1),e(!1))}),[e,t]);return{isShiftPressed:t,hoverProps:{onMouseEnter:o,onMouseLeave:i}}}((e=>{o&&o(e)})),v=c&&!0===h&&!g;return(0,s.jsx)(Mn.m,{label:u,disabled:i,...v?{w:c,multiline:!0}:{},children:(0,s.jsx)(Bn.M,{className:"transcript-action-button",size:"lg",color:a??"gray",variant:l??"default",onClick:()=>{r();const e="function"==typeof t?t():t;p(e),f(!0);const n=()=>setTimeout((()=>{p(d.current),f(!1)}),250);return m.current?.addEventListener("mouseleave",n),()=>m.current?.removeEventListener("mouseleave",n)},ref:m,disabled:i,...b,children:n})})},ls=({height:e})=>{const t=["80%","95%","99%"],n=["40%","50%","60%","70%",...Array.from({length:5},(()=>t)).flat()],r=Math.max(1,Math.floor((e-6)/14)-2);return(0,s.jsx)("div",{children:Array.from({length:r}).map(((e,t)=>(0,s.jsx)(De.E,{mt:6,height:8,radius:"xl",width:n[Math.floor(Math.random()*n.length)]},t)))})},cs=({isLoading:e,disabled:t,searchActions:n})=>{const{searchStarted:o,setSearchStarted:i,searchInfoMessage:a,setSearchInfoMessage:l}=Gn((0,Yn.k)((e=>({searchStarted:e.searchStarted,setSearchStarted:e.setSearchStarted,searchInfoMessage:e.searchInfoMessage,setSearchInfoMessage:e.setSearchInfoMessage})))),[c,h]=(0,Me.useState)(""),d=(0,Me.useRef)(null),[u,p]=(0,Me.useState)(!1),[m,g]=(0,Me.useState)(!1),f=(Wt((e=>e.prefs)),()=>d.current?.value??""),b=()=>{const e=f();i(!0),h(e),n.newSearch(e)},v="transcript-search-bar-input",x=()=>{h(""),n.clearSearch(),p(!1),i(!1),g(!1)};return(0,s.jsxs)(Je.Y,{className:"transcript-search-bar",children:[(0,s.jsx)(Vn.k,{ref:d,id:v,className:Le()("transcript-search-bar-input",a?.className),placeholder:"Search",description:a?(0,s.jsx)(s.Fragment,{children:a.message}):(0,s.jsx)(s.Fragment,{children:" "}),disabled:e||t,rightSectionPointerEvents:"all",rightSection:(0,s.jsx)(Ln.J,{"aria-label":"Clear search",onClick:()=>{x(),document.getElementById(v).value=""},style:{display:u?void 0:"none"}}),onChange:e=>{const t=e.target.value;""===t?x():t!==c&&(h(t),i(!1)),""!==t&&g(!0),l(null)},onKeyUp:e=>{const t=f();p(""!==t)},onKeyDown:e=>{const t=e.nativeEvent,s=r.Shortcuts.fromKeyDownEvent(t,r.CapsLock.Ignore),i=r.Shortcuts.modsSet(s),a=Xn.SystemSpecific.isMacOS()?"meta":"ctrl",l=f();"Enter"===s.key&&0===i.size?l===c&&o?n.goToNext():b():"Enter"===s.key&&1===i.size&&i.has("shift")?(l===c&&o||b(),n.goToPrevious()):"g"===s.key&&i.has(a)&&1===i.size?(t.preventDefault(),o&&n.goToNext()):"g"===s.key&&i.has(a)&&i.has("shift")&&2===i.size&&(t.preventDefault(),o&&n.goToPrevious())}}),(0,s.jsx)(Bn.M,{className:"transcript-search-bar-caret",variant:"default",size:"lg",disabled:e||t||!m,onClick:()=>{o||b(),n.goToPrevious()},children:(0,s.jsx)(Jn.A,{size:24,stroke:1.2})}),(0,s.jsx)(Bn.M,{className:"transcript-search-bar-caret",variant:"default",size:"lg",disabled:e||t||!m,onClick:()=>{const e=f();o?n.goToNext():(c!==e&&h(e),b())},children:(0,s.jsx)(qn.A,{size:24,stroke:1.2})})]})},hs=e=>{e.detail>1&&e.preventDefault()},ds=({group:e,timeCallback:t,rtl:n})=>{const r=N(e.start),o=e=>e>0,i=n?{dir:"rtl"}:{};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(Je.Y,{gap:"sm",justify:"flex-start",className:"ts-section",children:(0,s.jsxs)($e.E,{className:"ts-text",...i,children:[(0,s.jsx)("span",{className:Le()("ts-time",n?"ts-time-rtl":""),onClick:()=>t(e.start),onMouseDown:hs,children:r}),e.sections.map(((n,r)=>(0,s.jsx)(us,{section:n,timeCallback:t,initialSpace:o(r),sectionIndex:e.sectionIndex+r},n.start)))]})})})},us=({section:e,timeCallback:t,initialSpace:n,sectionIndex:r})=>{const o=Gn((e=>e.searchMatch)),i=function(e,t,n){const{startSection:s,startOffset:r,endSection:o,endOffset:i}=n,a=e.text;return t<s||t>o?{before:a,highlighted:"",after:""}:t>s&&t<o||t===s&&t===o&&0===r&&i===a.length-1?{before:"",highlighted:a,after:""}:t===s&&t===o?{before:a.substring(0,r),highlighted:a.substring(r,i+1),after:a.substring(i+1)}:t===s?{before:a.substring(0,r),highlighted:a.substring(r),after:""}:t===o?{before:"",highlighted:a.substring(0,i+1),after:a.substring(i+1)}:{before:a,highlighted:"",after:""}}(e,r,o),{before:a,highlighted:l,after:c}=i,h=a?e.id:void 0,d=l&&!h?e.id:void 0,u=!c||d||h?void 0:e.id;return(0,s.jsxs)(s.Fragment,{children:[n&&(0,s.jsx)(s.Fragment,{children:" "}),a&&(0,s.jsx)(Fn.C,{...h?{id:h}:{},onClick:()=>t(e.start),onMouseDown:hs,className:"ts-mark",children:a}),l&&(0,s.jsx)(Fn.C,{...d?{id:d}:{},onClick:()=>t(e.start),onMouseDown:hs,className:"ts-mark ts-mark-search",children:l}),c&&(0,s.jsx)(Fn.C,{...u?{id:u}:{},onClick:()=>t(e.start),onMouseDown:hs,className:"ts-mark",children:c})]})};var ps=n(7349),ms={};ms.styleTagTransform=Et(),ms.setAttributes=kt(),ms.insert=St().bind(null,"head"),ms.domAPI=vt(),ms.insertStyleElement=Ct();ft()(ps.Ay,ms);ps.Ay&&ps.Ay.locals&&ps.Ay.locals;var gs=n(4010),fs={};fs.styleTagTransform=Et(),fs.setAttributes=kt(),fs.insert=St().bind(null,"head"),fs.domAPI=vt(),fs.insertStyleElement=Ct();ft()(gs.A,fs);gs.A&&gs.A.locals&&gs.A.locals;var bs=n(6722);const vs=e=>{Wt((e=>e.prefs));const{uiActions:t,searchActions:n,extensionInstanceId:r}=e,[o,i]=(0,Me.useState)(!0),{transcriptOpen:a,buttonsBarVisible:l}=Gn((0,Yn.k)((e=>({transcriptOpen:e.transcriptOpen,buttonsBarVisible:e.buttonsBarVisible}))));return(0,s.jsxs)("div",{className:ps.qr,children:[(0,s.jsx)(ks,{uiActions:t,extensionInstanceId:r}),(0,s.jsx)(En.S,{in:a,onTransitionEnd:()=>{a&&o&&(i(!1),t.highlightAndJumpToCurrentSection())},children:(0,s.jsx)(ts,{uiActions:t,searchActions:n})}),(0,s.jsx)("div",{className:ps.u5,style:{display:l?"block":"none"}})]})};function xs(e,t,n){const o=n&&e.keys.openTranscript.enabled&&!r.Shortcuts.isEmpty(e.keys.openTranscript.shortcut)?(0,s.jsxs)(s.Fragment,{children:[" (shortcut: ",(0,mt.qA)(bs.ShortcutStringRendering.renderAsString(e.keys.openTranscript.shortcut),"sm"),")"]}):"";return t?(0,s.jsxs)(s.Fragment,{children:["Close the transcript",o]}):(0,s.jsxs)(s.Fragment,{children:["Show the transcript for this video",o]})}function Ss(e,t){const n=t&&e.keys.channelInfo.enabled&&!r.Shortcuts.isEmpty(e.keys.channelInfo.shortcut)?(0,s.jsxs)(s.Fragment,{children:[" (shortcut: ",(0,mt.qA)(bs.ShortcutStringRendering.renderAsString(e.keys.channelInfo.shortcut),"sm"),")"]}):"";return(0,s.jsxs)(s.Fragment,{children:["Information about the channel",n]})}function ys(e,t,n){const o=n&&e.keys.watchNextOverlays.enabled&&!r.Shortcuts.isEmpty(e.keys.watchNextOverlays.shortcut)?(0,s.jsxs)(s.Fragment,{children:[", shortcut: ",(0,mt.qA)(bs.ShortcutStringRendering.renderAsString(e.keys.watchNextOverlays.shortcut),"sm")]}):"";return t?(0,s.jsxs)(s.Fragment,{children:["Hide end-of-video buttons and links (currently visible",o,")"]}):(0,s.jsxs)(s.Fragment,{children:["Show end-of-video buttons and links (currently hidden",o,")"]})}const ks=e=>{const{uiActions:t,extensionInstanceId:n}=e,{buttonsBarVisible:r,transcriptOpen:o,setTranscriptOpen:i}=Gn((0,Yn.k)((e=>({buttonsBarVisible:e.buttonsBarVisible,transcriptOpen:e.transcriptOpen,setTranscriptOpen:e.setTranscriptOpen})))),{prefs:a,watchNextOverlaysVisible:l,setWatchNextOverlaysVisible:c,channelModalActive:h,setChannelModalActive:d}=Wt((0,Yn.k)((e=>({prefs:e.prefs,watchNextOverlaysVisible:e.watchNextOverlaysVisible,setWatchNextOverlaysVisible:e.setWatchNextOverlaysVisible,channelModalActive:e.channelModalActive,setChannelModalActive:e.setChannelModalActive})))),m={size:22,stroke:1.3},g=o?(0,s.jsx)(In.A,{...m}):(0,s.jsx)(On.A,{...m}),f={root:ps.HN,section:ps.i},b={variant:"default",size:"compact-xl",radius:"xl"};return(0,s.jsxs)("div",{className:ps.ni,style:{display:r?"flex":"none"},children:[(0,s.jsx)(ws,{position:"top",offset:-4,style:{border:"0.5px solid #707070"},label:Ss(a,!1),hoverTimeMs:u,labelAfterTimePassed:Ss(a,!0),children:(0,s.jsx)(Ke.$,{id:Ne.modalButtonId(n),classNames:{...f,root:ps.HN+(h?" "+ps.Xi:"")},...b,leftSection:(0,s.jsx)(jn.A,{...m}),onClick:()=>{d(!0),t.openChannelInfoModal()},children:"Channel "})}),(0,s.jsx)(ws,{position:"top",offset:-4,label:xs(a,o,!1),hoverTimeMs:u,labelAfterTimePassed:xs(a,o,!0),children:(0,s.jsx)(Ke.$,{id:Ne.transcriptButtonId(n),classNames:{...f,root:ps.HN+(o?" "+ps.Xi:"")},...b,leftSection:g,onClick:()=>i(!o),children:"Transcript "})}),(0,s.jsx)(ws,{position:"top",offset:-4,label:ys(a,l,!1),hoverTimeMs:u,labelAfterTimePassed:ys(a,l,!0),zIndex:p,children:(0,s.jsx)(Ke.$,{id:Ne.watchNextOverlaysButtonId(n),classNames:f,...b,leftSection:l?(0,s.jsx)(An.A,{...m}):(0,s.jsx)(Nn.A,{...m}),onClick:()=>{const e=!l;c(e),t.overrideRemoveWatchNextOverlays(!e)},children:"Watch next "})})]})},ws=({hoverTimeMs:e,labelAfterTimePassed:t,...n})=>{const r=(0,Me.useRef)(t),[o,i]=(0,Me.useState)(!1),[a,l]=(0,Me.useState)(n.label),[c,h]=(0,Me.useState)(null),d=()=>{c&&(clearTimeout(c),h(null));const t=setTimeout((()=>u()),e);h(t)},u=()=>{h(null),l(r.current)};return(0,Me.useEffect)((()=>{l(n.label)}),[n.label]),(0,Me.useEffect)((()=>{r.current=t,o&&d()}),[t]),(0,s.jsx)(Mn.m,{...n,label:a,onMouseEnter:()=>{d(),i(!0)},onMouseLeave:()=>{i(!1),c&&(clearTimeout(c),h(null)),l(n.label)},zIndex:p,children:n.children})},Cs=(0,we.a)({components:{}}),Ts=e=>{const t=(0,Ee.U)(),[n,r]=(0,Me.useState)(t);return(0,Me.useEffect)((()=>{r(t)}),[t]),(0,s.jsxs)(Me.StrictMode,{children:[(0,s.jsx)(Ce.c,{}),(0,s.jsx)(Te.y,{theme:Cs,forceColorScheme:n,children:(0,s.jsx)(vs,{uiActions:e.uiActions,searchActions:e.searchActions,extensionInstanceId:e.extensionInstanceId})})]})};class Es{prefs;jsxManager;extensionInstanceId;constructor(e,t){this.prefs=e,this.extensionInstanceId=t,this.jsxManager=new Be(e,t,"right-column")}updatePrefs(e){this.prefs=e,this.jsxManager.updatePrefs(e),Gn.setState({buttonsBarVisible:this.prefs.generalBoolOptions.addRightColumnButtons.enabled,searchStarted:!1}),Wt.setState({watchNextOverlaysVisible:!this.prefs.generalBoolOptions.removeWatchNextOverlays.enabled})}isRootCreated(){return this.jsxManager.isRootCreated()}removeRoot(){this.jsxManager.cleanupRoot()}async createContainer(e,t,n){this.jsxManager.isRootCreated()&&this.jsxManager.cleanupRoot();let r=e;const o=e.querySelector("#columns #secondary-inner");if(!o)return!1;r=o;const i=S();return!!i&&(this.setValuesInRightColumnStore(),this.setValuesInTranscriptStore(i),this.jsxManager.setRootAppender((e=>r.prepend(e))),await this.jsxManager.render((0,s.jsx)(Ts,{extensionInstanceId:this.extensionInstanceId,uiActions:t,searchActions:n})),!0)}setValuesInRightColumnStore(){Wt.setState({watchNextOverlaysVisible:!this.prefs.generalBoolOptions.removeWatchNextOverlays.enabled})}setValuesInTranscriptStore(e){Gn.setState({videoId:e,buttonsBarVisible:this.prefs.generalBoolOptions.addRightColumnButtons.enabled,searchMatch:yn,searchInfoMessage:null})}onVideoIdChange(e,t){this.isRootCreated()&&(null===t?this.jsxManager.cleanupRoot():this.setValuesInTranscriptStore(t))}onSearchMatchChange(e,t,n){const s={searchMatch:e};var r;(r=e).startSection===yn.startSection&&r.startOffset===yn.startOffset&&r.endSection===yn.endSection&&r.endOffset===yn.endOffset?s.searchInfoMessage=wn.notFound():void 0!==t&&void 0!==n&&(s.searchInfoMessage=wn.oneOfSeveral(t,n)),Gn.setState(s)}onResetSearch(){Gn.setState({searchMatch:yn,searchStarted:!1,searchInfoMessage:null})}onEndOfSearch(){}onTranscriptOpenChange(e){Gn.getState().setTranscriptOpen(e)}setWatchNextOverlaysVisible(e){Wt.getState().setWatchNextOverlaysVisible(e)}isTranscriptOpen(){return!!this.isRootCreated()&&Gn.getState().transcriptOpen}areWatchNextOverlaysVisible(){return!!this.isRootCreated()&&Wt.getState().watchNextOverlaysVisible}}class Ms{prefs;videoElement=null;watchInterval=null;onVideoElementChangedCallbacks=[];constructor(e){this.prefs=e,this.prefs}updatePrefs(e){this.prefs=e}startWatching(){this.watchInterval=setInterval((()=>{this.checkVideoElement()}),1e3)}checkVideoElement(){const e=P();e&&this.videoElement!==e&&(this.videoElement=e,this.onVideoElementChangedCallbacks.forEach((t=>t(e))))}stopWatching(){this.watchInterval&&(clearInterval(this.watchInterval),this.watchInterval=null)}onVideoElementChanged(e){this.onVideoElementChangedCallbacks.push(e)}}var Is=n(5940),Os={};Os.styleTagTransform=Et(),Os.setAttributes=kt(),Os.insert=St().bind(null,"head"),Os.domAPI=vt(),Os.insertStyleElement=Ct();ft()(Is.A,Os);Is.A&&Is.A.locals&&Is.A.locals;class As{static instance=new As;transcriptCache={};MAX_AGE_MS=72e5;MAX_SIZE=100;constructor(){}static getInstance(){return As.instance}cleanup(){(0,ve.A)(this.transcriptCache,this.MAX_AGE_MS,this.MAX_SIZE)}getTranscriptContents(e,t){this.cleanup();const n=this.buildCacheKey(e,t);return this.transcriptCache[n]?.data||null}setTranscriptContents(e,t,n){this.cleanup();const s=this.buildCacheKey(e,t);return this.transcriptCache[s]={data:n,savedAt:Date.now()},n}buildCacheKey(e,t){return`${e}:${t}`}}var Ns=function(e,t,n){for(var s=arguments.length>2,r=0;r<t.length;r++)n=s?t[r].call(e,n):t[r].call(e);return s?n:void 0},js=function(e,t,n,s,r,o){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,l=s.kind,c="getter"===l?"get":"setter"===l?"set":"value",h=!t&&e?s.static?e:e.prototype:null,d=t||(h?Object.getOwnPropertyDescriptor(h,s.name):{}),u=!1,p=n.length-1;p>=0;p--){var m={};for(var g in s)m[g]="access"===g?{}:s[g];for(var g in s.access)m.access[g]=s.access[g];m.addInitializer=function(e){if(u)throw new TypeError("Cannot add initializers after decoration has completed");o.push(i(e||null))};var f=(0,n[p])("accessor"===l?{get:d.get,set:d.set}:d[c],m);if("accessor"===l){if(void 0===f)continue;if(null===f||"object"!=typeof f)throw new TypeError("Object expected");(a=i(f.get))&&(d.get=a),(a=i(f.set))&&(d.set=a),(a=i(f.init))&&r.unshift(a)}else(a=i(f))&&("field"===l?r.unshift(a):d[c]=a)}h&&Object.defineProperty(h,s.name,d),u=!0};const Rs=1/30;function Ps(e){return function(...t){if(je.transcriptButtonExists(this.extensionInstanceId))return e.apply(this,t)}}let Bs=(()=>{let e,t,n=[];return class{static{const s="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[Ps],t=[Ps],js(this,null,e,{kind:"method",name:"updateCurrentSection",static:!1,private:!1,access:{has:e=>"updateCurrentSection"in e,get:e=>e.updateCurrentSection},metadata:s},null,n),js(this,null,t,{kind:"method",name:"triggerSectionChange",static:!1,private:!1,access:{has:e=>"triggerSectionChange"in e,get:e=>e.triggerSectionChange},metadata:s},null,n),s&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s})}prefs=Ns(this,n);transcript;videoElement=null;currentSectionIndex=-1;lastKnownTime=0;onSectionChange;onVideoTimeChange=null;jumpThreshold=5;maxLinearSearchSteps=5;followingVideo=!0;extensionInstanceId;constructor(e,t){this.prefs=e,this.prefs,this.transcript={sections:[]},this.extensionInstanceId=t}updatePrefs(e){this.prefs=e}updateTranscript(e){this.transcript=e}setFollowingVideo(e){Gn.getState().setFollowingVideo(e),this.followingVideo=e}isFollowingVideo(){return this.followingVideo}attachVideoElement(e){this.videoElement&&this.detachListeners(this.videoElement),this.videoElement=e,this.attachListeners(e),this.updateCurrentSection(!0)}detachVideoElement(){this.videoElement&&(this.detachListeners(this.videoElement),this.videoElement=null)}setTranscriptContents(e){this.transcript=e,this.currentSectionIndex=-1,this.videoElement&&this.updateCurrentSection(!0)}setOnSectionChangeCallback(e){this.onSectionChange=e}attachListeners(e){e.addEventListener("timeupdate",this.handleTimeUpdate),e.addEventListener("play",this.handlePlayOrSeek),e.addEventListener("pause",this.handlePlayOrSeek),e.addEventListener("seeked",this.handlePlayOrSeek)}detachListeners(e){e.removeEventListener("timeupdate",this.handleTimeUpdate),e.removeEventListener("play",this.handlePlayOrSeek),e.removeEventListener("pause",this.handlePlayOrSeek),e.removeEventListener("seeked",this.handlePlayOrSeek)}setOnVideoTimeChangeCallback(e){this.onVideoTimeChange=e}handlePlayOrSeek=()=>{this.updateCurrentSection(!0)};handleTimeUpdate=()=>{this.updateCurrentSection()};updateCurrentSection(e=!1){if(!this.videoElement||0===this.transcript.sections.length)return;const t=this.videoElement.currentTime;this.onVideoTimeChange&&this.onVideoTimeChange(t);const n=this.transcript.sections,s=this.currentSectionIndex,r=s>=0?n[s]:null;if(r&&this.isTimeInSection(t,r))return void(this.lastKnownTime=t);const o=Math.abs(this.lastKnownTime-t)>this.jumpThreshold;let i=-1;e||o||s<0?i=this.binarySearchForSection(t):(i=this.linearSearchFromIndex(s,t),i<0&&(i=this.binarySearchForSection(t))),i>=0&&i<n.length-1&&this.isTimeInSection(t+Rs,n[i+1])&&i++,this.currentSectionIndex=i,this.lastKnownTime=t,this.triggerSectionChange()}isTimeInSection(e,t){return e>=t.start&&e<t.start+t.duration}linearSearchFromIndex(e,t){const n=this.transcript.sections;let s=0,r=e;for(;r>0&&t<n[r].start&&s<this.maxLinearSearchSteps;)if(r--,s++,this.isTimeInSection(t,n[r]))return r;for(r=e,s=0;r<n.length-1&&t>=n[r].start+n[r].duration&&s<this.maxLinearSearchSteps;)if(r++,s++,this.isTimeInSection(t,n[r]))return r;return this.isTimeInSection(t,n[r])?r:-1}binarySearchForSection(e){const t=this.transcript.sections;let n=0,s=t.length-1;for(;n<=s;){const r=n+s>>>1,o=t[r],i=o.start+o.duration;if(e<o.start)s=r-1;else{if(!(e>=i))return r;n=r+1}}return-1}triggerSectionChange(){if(!this.onSectionChange)return;const e=this.sectionForCurrentIndex();this.onSectionChange(e)}sectionForCurrentIndex(){return this.getSectionAtIndex(this.currentSectionIndex)}getSectionAtIndex(e){return e>=0&&e<this.transcript.sections.length?this.transcript.sections[e]:null}closestSectionForCurrentTime(){const e=this.videoElement?.currentTime;if(void 0===e)return null;const t=this.binarySearchClosestSection(e);return this.getSectionAtIndex(t)}binarySearchClosestSection(e){const t=this.transcript.sections;if(0===t.length)return-1;if(e<=t[0].start)return 0;if(e>=t[t.length-1].start+t[t.length-1].duration)return t.length-1;let n=0,s=t.length-1;for(;n<=s;){const r=n+s>>>1,o=t[r],i=o.start,a=i+o.duration;if(e>=i&&e<a)return r;if(s-n<=1){const r=t[n],o=t[s];return Math.min(Math.abs(e-r.start),Math.abs(e-(r.start+r.duration)))<=Math.min(Math.abs(e-o.start),Math.abs(e-(o.start+o.duration)))?n:s}e<i?s=s===r?r-1:r:n=n===r?r+1:r}return n}}})();var Vs,Ls,Fs;!function(e){e.XML="",e.JSON="json3",e.SRV1="srv1",e.SRV2="srv2",e.SRV3="srv3",e.TTML="ttml",e.VTT="vtt"}(Vs||(Vs={}));class _s{prefs;extensionInstanceId;transcriptFollower;transcriptSearch;rightColumnInjector;lastSearchMatchLoopedBack;lastTranscriptSection=null;pauseFollowUntilMs=null;extensionWasUnloaded=!1;constructor(e,t,n){this.prefs=e,this.extensionInstanceId=t,this.extensionInstanceId,this.transcriptFollower=new Bs(e,t),this.transcriptSearch=new Tn(e,[]),this.rightColumnInjector=n,this.lastSearchMatchLoopedBack=!1,this.transcriptSearch.onResetSearch((()=>{this.rightColumnInjector.onResetSearch()})),this.transcriptSearch.onNotFound((()=>{this.rightColumnInjector.onSearchMatchChange(yn)})),this.transcriptSearch.onSearchHit(((e,t,n)=>{this.rightColumnInjector.onSearchMatchChange(e,t,n)})),this.transcriptSearch.onEndOfSearch((e=>{this.lastSearchMatchLoopedBack=!0,this.rightColumnInjector.onEndOfSearch()})),this.transcriptFollower.setOnVideoTimeChangeCallback((e=>{this.transcriptSearch.updateVideoTimeSec(e)}))}shutdown(){this.extensionWasUnloaded=!0,this.transcriptFollower.detachVideoElement()}updatePrefs(e){this.prefs=e,this.transcriptFollower.updatePrefs(e),this.transcriptSearch.updatePrefs(e)}onVideoElementChanged(e){this.transcriptFollower.attachVideoElement(e)}onVideoIdChange(e,t){this.transcriptFollower.detachVideoElement(),this.transcriptFollower.setFollowingVideo(!0)}onFollowModeChange(e){this.transcriptFollower.setFollowingVideo(e),this.updateHighlightForCurrentSection(e)}highlightAndJumpToCurrentSection(){this.transcriptFollower.isFollowingVideo()&&this.updateHighlightForCurrentSection(!0,"instant")}onTranscriptLanguageChange(e){this.transcriptFollower.setTranscriptContents(e),this.updateHighlightForCurrentSection(this.transcriptFollower.isFollowingVideo())}buildSearchActions(){return{newSearch:e=>this.searchNew(e),clearSearch:()=>this.clearSearch(),goToNext:()=>this.searchGoToNext(),goToPrevious:()=>this.searchGoToPrevious()}}searchNew(e){this.prefs.logger.debug("[content] searchNew: searchTerm:",e);const t=this.transcriptSearch.search(e);this.prefs.logger.debug("[content] searchNew, about to scroll: searchTerm:",e,"match:",t),this.attemptScrollToMatch(t,"instant")}clearSearch(){this.transcriptSearch.clearSearch(),this.prefs.logger.debug("[content] clearSearch: done"),this.pauseFollowUntilMs=null}searchGoToNext(){const e=this.transcriptSearch.goToNext();this.prefs.logger.debug("[content] searchGoToNext: match:",e),this.searchGoToMatch(e)}searchGoToPrevious(){const e=this.transcriptSearch.goToPrevious();this.prefs.logger.debug("[content] searchGoToPrevious: match:",e),this.searchGoToMatch(e)}searchGoToMatch(e){this.attemptScrollToMatch(e,this.lastSearchMatchLoopedBack?"instant":"smooth"),this.lastSearchMatchLoopedBack=!1}attemptScrollToMatch(e,t){if(this.prefs.logger.debug("[content] attemptScrollToMatch: match:",e,"allowed:",this.isTranscriptScrollAllowed("to-search-match",t)),this.isTranscriptScrollAllowed("to-search-match",t)&&e){const n=e.startSection,s=this.transcriptFollower.getSectionAtIndex(n);if(this.prefs.logger.debug("[content] attemptScrollToMatch: section:",s),s){const e=document.getElementById(s.id);this.prefs.logger.debug("[content] attemptScrollToMatch: curMarkElement:",e),e&&(this.pauseTranscriptFollowerOnSearch(),e.scrollIntoView({behavior:t,block:"nearest"}))}}}pauseTranscriptFollowerOnSearch(){this.pauseFollowUntilMs=Date.now()+1e4}async initializeTranscript(e){const t=await(0,Yt.nodeBecomesAvailable)("video",document.body,R,1e4);if(this.extensionWasUnloaded)return this.prefs.logger.debug("[content] initializeTranscript: extension was unloaded, stopping here"),null;if(!t)return this.prefs.logger.debug("[content] initializeTranscript: no video element found, cannot attach transcript follower"),new Promise(((t,n)=>setTimeout((()=>t(this.initializeTranscript(e))),1e3)));const n=await async function(e){let t=await ce(e);const n=ae("S0hYREFBDRNaR0BFRQ0XFllUUk5bUTRvOywxMTMlLWcpJCFiPW0=");if(t.includes(n)){const n=function(e){const t=e.match(/name="v" value="(.*?)"/);return t?t[1]:null}(t);if(n){const s=`${ae("aWRifmthZAxrdmc=")}+${n}; domain=.youtube.com`;t=await ce(e,s)}}const s=ae("Y2ViaHx7ZXN3bHVlf2hzfGM="),r=new RegExp(`"${s}":\\s*"([a-zA-Z0-9_-]+)"`),o=t.match(r);return o?o[1]:null}(e);let s=null;if(n){let t=await he(e,n);de(t)||(t=await he(e,n,!1)),de(t)&&(s=function(e){if(!("captions"in e))return null;const t=e.captions;if(!(ae("WkdNVEtdc1BCR11aWERsS1tYV1FXTDQTJy0gIDQiOg==")in t))return null;const n=t.playerCaptionsTracklistRenderer;return{...n,captionTracks:ue(n.captionTracks)}}(t))}return null===s&&(s=await async function(e,t,n=3,s=1e3){let r=null,o=1;for(;o<=n;){if(r=await e(),null!==r&&t(r))return r;o++,await new Promise((e=>setTimeout(e,s)))}return r}((()=>async function(e){return me(await ce(e),'"captions":',(e=>"playerCaptionsTracklistRenderer"in e),(e=>e.playerCaptionsTracklistRenderer))}(e)),(e=>le(e)),d.MAX_ATTEMPTS,d.DELAY_MILLIS)),s&&le(s)?(this.transcriptFollower.attachVideoElement(t),this.transcriptFollower.setOnSectionChangeCallback((e=>{this.onTranscriptSectionChange(e)})),{videoId:e,contentsByLanguage:{},otherLanguages:s.captionTracks}):null}async loadTranscriptContents(e,t){const n=e.videoId,s=As.getInstance().getTranscriptContents(n,t);if(s)return this.lastTranscriptSection=null,this.prepareTranscriptContentsBeingLoaded(s);const r=e.otherLanguages.find((e=>e.vssId===t));if(!r)return this.prefs.logger.debug("[content] loadTranscript: no track found for languageVssId:",t),null;const o=hn(function(e){const t=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("text");return{sections:Array.from(t).map((e=>({start:parseFloat(e.getAttribute("start")||"0"),duration:parseFloat(e.getAttribute("dur")||"0"),text:e.textContent||""}))).sort(((e,t)=>e.start-t.start))}}(await async function(e){const t=e.baseUrl,n=await fetch(t);return await n.text()}(r)),r.vssId,n);return As.getInstance().setTranscriptContents(n,t,o),function(e,t,n){const s={...e.contentsByLanguage};s[n.vssId]={sections:t.sections,languageVssId:n.vssId,languageCode:n.languageCode,languagePrintName:n.name.simpleText};const r=e.otherLanguages.filter((e=>e.vssId!==n.vssId));e.contentsByLanguage=s,e.otherLanguages=r}(e,o,r),this.prepareTranscriptContentsBeingLoaded(o)}prepareTranscriptContentsBeingLoaded(e){return this.transcriptFollower.setTranscriptContents(e),this.transcriptSearch.updateSections(e.sections),this.lastTranscriptSection=null,e}onTranscriptSectionChange(e,t,n=!1){const s=null!==e&&null!==this.lastTranscriptSection&&e.id===this.lastTranscriptSection.id,r=null===e&&null===this.lastTranscriptSection;if(n||!s&&!r){if(this.lastTranscriptSection){const e=document.getElementById(this.lastTranscriptSection.id);e&&this.removeHighlightFromTranscriptElement(e)}if(e){const n=document.getElementById(e.id);n?this.highlightAndScrollToTranscriptElement(n,t):this.waitForMarkAndHighlightIfStillActive(e)}this.lastTranscriptSection=e,null===e&&this.scrollToClosestSectionForCurrentTime(t)}else s||this.scrollToClosestSectionForCurrentTime(t)}scrollToClosestSectionForCurrentTime(e){if(!this.isTranscriptScrollAllowed("to-current-follow",e))return;const t=this.transcriptFollower.closestSectionForCurrentTime();if(t){const n=document.getElementById(t.id);n&&n.scrollIntoView({behavior:e??"smooth",block:"nearest"})}}updateHighlightForCurrentSection(e,t){const n=this.transcriptFollower.sectionForCurrentIndex(),s=n?document.getElementById(n.id):null;s&&(e?this.highlightAndScrollToTranscriptElement(s,t):this.removeHighlightFromTranscriptElement(s))}highlightAndScrollToTranscriptElement(e,t){e.classList.add(h),this.isTranscriptScrollAllowed("to-current-follow",t)&&this.placeCurrentTranscriptMark(e,this.prefs.transcriptOptions.transcriptHighlightPosition,t)}placeCurrentTranscriptMark(e,t,n){const s=document.getElementById("transcript-block");if(!s||!e)return;const r=s.clientHeight,o=s.scrollHeight,i=s.getBoundingClientRect(),a=e.getBoundingClientRect().bottom-i.top+s.scrollTop;let l;if(t===$.Middle){const t=5;l=a-r/2-e.offsetHeight/2+t}else l=t===$.Top?a-100:a-r+e.offsetHeight;const c=Math.max(0,Math.min(l,o-r));this.smoothScrollTo(s,c)}smoothScrollTo(e,t,n=500){const s=e.scrollTop,r=t-s;let o=null;window.requestAnimationFrame((function t(i){o||(o=i);const a=i-o,l=Math.min(a/n,1),c=(h=l,1-Math.pow(1-h,3));var h;e.scrollTop=s+r*c,a<n&&window.requestAnimationFrame(t)}))}isTranscriptScrollAllowed(e,t){const n=document.getElementById("transcript-block"),s=this.transcriptFollower.isFollowingVideo(),r=null!==n&&function(e){const t=e.getBoundingClientRect(),n=window.innerHeight;return t.bottom<=0||t.top>=n?0:(Math.min(t.bottom,n)-Math.max(t.top,0))/t.height}(n)>.5,o="to-current-follow"===e&&null!==this.pauseFollowUntilMs&&Date.now()<this.pauseFollowUntilMs;return("to-current-follow"===e&&s||"to-search-match"===e&&r)&&null===document.fullscreenElement&&("instant"===t||r)&&!o}removeHighlightFromTranscriptElement(e){e.classList.remove(h)}waitForMarkAndHighlightIfStillActive(e){(0,Yt.nodeBecomesAvailable)(`#${e.id}`,document.body,void 0,8e3).then((t=>{if(this.extensionWasUnloaded)return void this.prefs.logger.debug("[content] waitForMark: element FOUND LATER for section ${section.id}, but extension was unloaded, SKIPPING");const n=P();n&&n.currentTime>=e.start&&n.currentTime<=e.start+e.duration&&this.highlightAndScrollToTranscriptElement(t)})).catch((e=>{}))}}!function(e){e.AUTO_HIDE="ytp-autohide",e.PAUSED_MODE="paused-mode",e.PLAYING_MODE="playing-mode"}(Ls||(Ls={})),function(e){e.SHOW="SHOW",e.HIDE="HIDE"}(Fs||(Fs={}));const Ds="cfy-ext-progress-bar-tick",Us="cfy-ext-progress-bar-tick-wrapper",Ws="data-tick-index",zs="cfy-ext-progress-bar-tick-gray",Hs="cfy-ext-progress-bar-tick-red",$s="div.ytp-chrome-bottom",Js=`${$s} div.ytp-progress-bar-container`,qs=`${$s} div.ytp-chapters-container div.ytp-chapter-hover-container`;class Xs{prefs;videoElement=null;watchingVideoElement=!1;progressBarVisibilityController;ticksVisible=!1;videoSize={width:0,height:0};resizeObserver;constructor(e,t){this.prefs=e,this.prefs,this.progressBarVisibilityController=t,this.resizeObserver=new ResizeObserver((e=>{this.updateVideoSize()}))}updatePrefs(e){this.prefs=e}startWatchingVideoElement(){return!!this.videoElement&&(!this.watchingVideoElement&&(this.videoElement.addEventListener("timeupdate",this.onVideoTimeUpdate),this.videoElement.addEventListener("play",this.onVideoTimeUpdate),this.videoElement.addEventListener("pause",this.onVideoTimeUpdate),this.videoElement.addEventListener("seeked",this.onVideoTimeUpdate),this.resizeObserver.observe(this.videoElement),this.watchingVideoElement=!0,this.onVideoTimeUpdate(),!0))}stopWatchingVideoElement(){this.videoElement&&this.watchingVideoElement&&(this.videoElement.removeEventListener("timeupdate",this.onVideoTimeUpdate),this.videoElement.removeEventListener("play",this.onVideoTimeUpdate),this.videoElement.removeEventListener("pause",this.onVideoTimeUpdate),this.videoElement.removeEventListener("seeked",this.onVideoTimeUpdate),this.resizeObserver.unobserve(this.videoElement),this.watchingVideoElement=!1)}updateVideoSize(){const e=this.queryProgressBar();if(!this.videoElement||!e)return;const t=this.videoElement.getBoundingClientRect();if(t.width===this.videoSize.width&&t.height===this.videoSize.height)return;this.videoSize={width:t.width,height:t.height};const n=Gs.detectChapters(),s=this.queryTicks(e);this.placeTicksHorizontally(s,n)}placeTicksHorizontally(e,t){const n=this.getUsefulProgressBarWidth(t);for(const s of e){const e=parseInt(s.getAttribute(Ws)||"0",10)/10*n,r=this.convertUsefulTickOffsetToActualOffset(e,t);s.style.left=`${r}px`}}addTicks(e){const t=document.createElement("div");t.classList.add(Us);const n=[];for(let e=1;e<=9;e++){const s=document.createElement("div");s.setAttribute(Ws,`${e}`),s.classList.add(Ds),n.push(s),t.appendChild(s)}const s=Gs.detectChapters();this.placeTicksHorizontally(n,s),e.appendChild(t)}getUsefulProgressBarWidth(e){return e.reduce(((e,t)=>e+t.width),0)}convertUsefulTickOffsetToActualOffset(e,t){if(t.length<=1)return e;let n=0,s=0,r=0;for(const o of t){const t=n+o.width+o.marginRight,i=s+o.width;if(i>e){r=n+(e-s);break}n=t,s=i}return r}removeTicksAndStopWatchingVideoElement(){this.removeTicks(),this.stopWatchingVideoElement()}removeTicks(){const e=this.queryProgressBar();if(!e)return;const t=this.queryTickWrapper(e);t&&t.remove()}queryTickWrapper(e){return e.querySelector(`div.${Us}`)}queryTicks(e){return Array.from(e.querySelectorAll(`div.${Us} div.${Ds}`))}queryProgressBar(){return document.querySelector(Js)}areTicksVisible(){return this.ticksVisible}toggleTicks(){const e=this.queryProgressBar();e&&this.videoElement&&(this.ticksVisible?this.disableTicks():this.enableTicks(e))}enableTicks(e){this.videoElement&&(this.removeTicksAndStopWatchingVideoElement(),this.addTicks(e),this.startWatchingVideoElement(),this.progressBarVisibilityController.showOrHideProgressBar(this.videoElement,Fs.SHOW),this.ticksVisible=!0)}disableTicks(){this.removeTicksAndStopWatchingVideoElement(),this.ticksVisible=!1}onVideoIdChange(){this.removeTicksAndStopWatchingVideoElement();const e=P();e&&(this.videoElement=e),this.disableTicks(),this.watchingVideoElement=!1}onVideoTimeUpdate=e=>{if(!this.videoElement)return;if(!this.watchingVideoElement)return;const t=this.queryProgressBar();if(!t)return;const n=this.videoElement.currentTime/this.videoElement.duration,s=this.queryTicks(t);for(const e of s){parseInt(e.getAttribute(Ws)||"0",10)/10<=n?(e.classList.add(Hs),e.classList.remove(zs)):(e.classList.remove(Hs),e.classList.add(zs))}}}class Ks{prefs;videoElement=null;constructor(e){this.prefs=e}updatePrefs(e){this.prefs=e}onVideoIdChange(){this.prefs.logger.debug("[CJC] onVideoIdChange"),this.videoElement=P(),this.computeTimestampsForChapters()}computeTimestampsForChapters(){if(!this.videoElement)return void this.prefs.logger.debug("[PBTC] computeTimestampsForChapters: no video element");this.prefs.logger.debug("[PBTC] computeTimestampsForChapters");const e=Gs.detectChapters();this.prefs.logger.debug("[PBTC] chapters:",e)}}class Gs{static detectChapters(){const e=Array.from(document.querySelectorAll(qs)),t=[];let n=0;for(const s of e){const e=s.getBoundingClientRect(),r=window.getComputedStyle(s),o=parseFloat(r.marginRight),i=e.width,a=n;t.push({startX:a,width:i,marginRight:o}),n+=i+o}return t}}class Ys{prefs;mouseMovementsTimeout=null;constructor(e){this.prefs=e,this.prefs}updatePrefs(e){this.prefs=e}showProgressBar(e){this.showOrHideProgressBar(e,Fs.SHOW)}showOrHideProgressBar(e,t){const n=(()=>{const e=document.querySelector("div.html5-video-player");return e||null})();if(!n)return;t===Fs.HIDE&&this.mouseMovementsTimeout&&(clearTimeout(this.mouseMovementsTimeout),this.mouseMovementsTimeout=null);const s=n.classList.contains(Ls.AUTO_HIDE);s&&t===Fs.SHOW&&n.classList.remove(Ls.AUTO_HIDE),e.paused?(n.classList.remove(Ls.PLAYING_MODE),n.classList.add(Ls.PAUSED_MODE)):(n.classList.remove(Ls.PAUSED_MODE),n.classList.add(Ls.PLAYING_MODE),s&&t===Fs.SHOW&&this.sendMouseMovements(e,250))}sendMouseMovements(e,t){const n=Date.now(),s={count:0,deltaX:0,deltaY:0},r=()=>{const o=e.getBoundingClientRect(),i=Math.round(o.left+o.width/2)+s.deltaX,a=Math.round(o.top+o.height/2)+s.deltaY,l=new MouseEvent("mousemove",{bubbles:!0,clientX:i,clientY:a});e.dispatchEvent(l),s.deltaX+=10*Math.random()-5,s.deltaY+=10*Math.random()-5,s.count++;Date.now()-n<t&&(this.mouseMovementsTimeout=setTimeout(r,50))};this.mouseMovementsTimeout=setTimeout(r,50)}}const Zs=!0,Qs=!1;function er(e){e.then((()=>!0)).catch((()=>!0))}const tr=new class{prefs;lastKeyPressMs;timeJumpMonitor;contentCssInjector;rightColumnInjector;jsxManager;progressBarVisibilityController;progressBarTickController;chapterJumpController;channelInfoModalVisible=!1;wasPlayingBeforeModal=!1;keyboardEventHandler;extensionReloadTimer=null;onStorageChangedHandler;onBeforeUnloadHandler;extensionWasUnloaded=!1;secondaryColumnPromise=null;videoElementWatcher;transcriptActions;extensionInstanceId;constructor(e){this.prefs=e,this.lastKeyPressMs=Date.now(),this.extensionInstanceId=`controls-for-youtube-prod-${(new Date).getTime()}`,this.timeJumpMonitor=new re(this.prefs),this.contentCssInjector=new Gt(this.prefs,this.extensionInstanceId),this.rightColumnInjector=new Es(this.prefs,this.extensionInstanceId),this.jsxManager=new Be(this.prefs,this.extensionInstanceId,"channel-info-modal"),this.progressBarVisibilityController=new Ys(this.prefs),this.progressBarTickController=new Xs(this.prefs,this.progressBarVisibilityController),this.chapterJumpController=new Ks(this.prefs),this.keyboardEventHandler=e=>er(tr.onKeyboardEvent(e)),this.onStorageChangedHandler=(e,t)=>this.onStorageChanged(e,t),this.onBeforeUnloadHandler=e=>this.onBeforeUnload(e),this.videoElementWatcher=new Ms(this.prefs),this.transcriptActions=new _s(this.prefs,this.extensionInstanceId,this.rightColumnInjector)}installListenersAtStartup(){this.contentCssInjector.startMonitoring(),this.videoElementWatcher.startWatching(),this.videoElementWatcher.onVideoElementChanged((e=>{this.transcriptActions.onVideoElementChanged(e)})),chrome.storage.onChanged.addListener(this.onStorageChangedHandler),addEventListener("beforeunload",this.onBeforeUnloadHandler),this.timeJumpMonitor.startMonitoring(),this.timeJumpMonitor.registerVideoIdChangeCb(((e,t)=>{er(this.onVideoIdChange(e,t))})),this.timeJumpMonitor.registerUrlChangeCb(((e,t)=>{er(this.onUrlChange())})),this.progressBarTickController.onVideoIdChange(),this.chapterJumpController.onVideoIdChange(),this.timeJumpMonitor.registerShortVideoLoopCb((()=>{this.prefs.generalBoolOptions.shortsAutoPlayNext.enabled&&this.startNextShort()}))}onStorageChanged(e,t){if(t===_.sV.getStorageNamespace()&&e.prefs){const t=ee.validateAndRebuildUserPrefsObjects(e.prefs.newValue,!1);this.updatePrefs(t)}}onTimestampClicked(e){const t=P();t&&(t.currentTime=e)}startNextShort(){const e=document.querySelectorAll('yt-button-shape button[aria-label="Next video"]');e.length>0&&e[0].click()}async onUrlChange(){await this.hideChannelInfoModal()}monitorKeyPressAndReloadEvents(){addEventListener(a,this.keyboardEventHandler),this.extensionReloadTimer=setInterval((()=>this.onExtensionReload()),1e3)}onExtensionReload(){chrome&&chrome.runtime&&chrome.runtime.id||(this.prefs.logger.debug("onExtensionReload: NO RUNTIME -> shutting down all listeners/timers/etc."),this.extensionWasUnloaded=!0,removeEventListener(a,this.keyboardEventHandler),this.videoElementWatcher.stopWatching(),chrome.storage&&chrome.storage.onChanged&&chrome.storage.onChanged.removeListener(this.onStorageChangedHandler),removeEventListener("beforeunload",this.onBeforeUnloadHandler),this.contentCssInjector.stopMonitoring(),this.rightColumnInjector.isRootCreated()&&(this.prefs.logger.debug("[cleanup] Transcript container JSX root found -> removing it"),this.rightColumnInjector.removeRoot()),this.transcriptActions.shutdown(),this.jsxManager.isRootCreated()&&(this.prefs.logger.debug("[cleanup] Channel modal JSX root found -> removing it"),this.jsxManager.cleanupRoot()),this.timeJumpMonitor.stopMonitoring(),this.progressBarTickController.disableTicks(),this.extensionReloadTimer&&clearInterval(this.extensionReloadTimer),this.prefs.logger.debug("onExtensionReload: ALL SHUT DOWN - bye!"))}async onVideoIdChange(e,t){await this.hideChannelInfoModal(),this.contentCssInjector.onVideoIdChange(),this.runTasksOnceLoaded(),this.transcriptActions.onVideoIdChange(e,t),this.rightColumnInjector.onVideoIdChange(e,t),this.progressBarTickController.onVideoIdChange()}runTasksOnceLoaded(){this.waitForSecondaryAndAddButtonsBar()}waitForSecondaryAndAddButtonsBar(){if(!E())return;const e=document.querySelector("div#columns"),t=e||document.body;this.secondaryColumnPromise=(0,Yt.nodeBecomesAvailable)("div#columns div#secondary",t),this.secondaryColumnPromise.then((e=>{this.extensionWasUnloaded?this.prefs.logger.debug("[content] Secondary column found, but extension was unloaded, SKIPPING"):this.addButtonsBarToSecondaryColumn(e)})).catch((e=>{this.prefs.logger.debug("[content] Error finding secondary column:",e),this.secondaryColumnPromise=null}))}addButtonsBarToSecondaryColumn(e){if(this.rightColumnInjector.isRootCreated())return;const t={openChannelInfoModal:()=>er(this.buttonOpenChannelInfoModal()),overrideRemoveWatchNextOverlays:e=>this.contentCssInjector.overrideRemoveWatchNextOverlays(e),initializeTranscript:e=>this.transcriptActions.initializeTranscript(e),getTranscriptContents:(e,t)=>this.transcriptActions.loadTranscriptContents(e,t),onTimestampClicked:e=>this.onTimestampClicked(e),copyTranscript:(e,t)=>function(e,t){B(dn(e,t))}(e,t),copyVideoLink:()=>function(){const e=S(),t=P();if(!e||!E()||!t)return;B(`https://www.youtube.com/watch?v=${e}&t=${Math.floor(t.currentTime)}`)}(),onFollowModeChange:e=>this.transcriptActions.onFollowModeChange(e),highlightAndJumpToCurrentSection:()=>this.transcriptActions.highlightAndJumpToCurrentSection(),onTranscriptLanguageChange:e=>this.transcriptActions.onTranscriptLanguageChange(e)},n=this.transcriptActions.buildSearchActions();this.rightColumnInjector.createContainer(e,t,n).then((()=>{})).catch((e=>{this.prefs.logger.debug("[content] Error creating right column container:",e)}))}onBeforeUnload(e){}updatePrefs(e){this.prefs=e,this.jsxManager.updatePrefs(e),Wt.setState({prefs:e}),this.videoElementWatcher.updatePrefs(e),this.contentCssInjector.updatePrefs(e),this.rightColumnInjector.updatePrefs(e),this.transcriptActions.updatePrefs(e),this.progressBarTickController.updatePrefs(e),this.chapterJumpController.updatePrefs(e),this.progressBarVisibilityController.updatePrefs(e)}processInitialCssRemovals(){this.contentCssInjector.initialize()}showNotificationWithEmojiSwitch(e,t){v(function(e,t,n){return e?t+" "+n:n}(this.prefs.generalBoolOptions.enableNotificationEmojis.enabled,e,t),this.notifDurationMs())}notifDurationMs(){return this.prefs.generalNumberOptions.notificationsDurationMs.amount}shouldIgnoreThisKeyPress(e){const t=Date.now();return t-this.lastKeyPressMs<70||(this.lastKeyPressMs=t,!!(0,r.isEventInTextField)(e))}async onKeyboardEvent(e){if(this.shouldIgnoreThisKeyPress(e))return;const t=this.prefs,n=P(),s=S(),r=T();(this.handledLikeDislike(t,e)||await this.handledChannelInfo(n,e)||n&&s&&r&&this.shortsHandlePlusTenSecs(n,e)||n&&this.handledSmallTimeJumps(t,n,e)||n&&s&&this.handledBookmarkRestoreUndo(n,s,e)||n&&this.handledFasterOrSlower(n,e)||n&&this.handledPictureInPicture(n,e)||s&&this.handledDisplayTicksTemporarily(e)||s&&this.handledOpeningTranscript(e)||s&&this.handledToggleWatchNextOverlays(e)||s&&n&&T()&&await this.handledShortsViewerKeyboardEvent(s,n,e))&&m(e)}handledDisplayTicksTemporarily(e){return D.matchesEvent(this.prefs,this.prefs.keys.progressBarTicks,e)?(this.progressBarTickController.toggleTicks(),this.prefs.keys.progressBarTicks.feedback===V.showNotification&&this.showNotificationWithEmojiSwitch("⏱️",this.progressBarTickController.areTicksVisible()?"Displaying progress bar ticks":"Hiding progress bar ticks"),Zs):Qs}shortsHandlePlusTenSecs(e,t){if(D.matchesEvent(this.prefs,i.SHORTCUT_PLUS_TEN_SEC_L,t)){const t=T(),n=e.currentTime+10>e.duration;if(t&&n)return this.startNextShort(),Zs}return Qs}handledOpeningTranscript(e){if(D.matchesEvent(this.prefs,this.prefs.keys.openTranscript,e)&&je.transcriptButtonExists(this.extensionInstanceId)){this.rightColumnInjector.isTranscriptOpen()||this.prefs.keys.openTranscript.feedback!==V.showNotification||this.showNotificationWithEmojiSwitch("📄","Opening transcript");const e=je.getTranscriptButton(this.extensionInstanceId);if(e)return e.click(),Zs}return Qs}handledToggleWatchNextOverlays(e){if(D.matchesEvent(this.prefs,this.prefs.keys.watchNextOverlays,e)&&je.watchNextOverlaysButtonExists(this.extensionInstanceId)){const e=!this.rightColumnInjector.areWatchNextOverlaysVisible();return this.rightColumnInjector.setWatchNextOverlaysVisible(e),this.contentCssInjector.overrideRemoveWatchNextOverlays(!e),this.prefs.keys.watchNextOverlays.feedback===V.showNotification&&this.showNotificationWithEmojiSwitch("👀",'"Watch next" overlays: '+(e?"visible":"hidden")),Zs}return Qs}handledPictureInPicture(e,t){if(D.matchesEvent(this.prefs,this.prefs.keys.pictureInPicture,t)){const n=this.prefs.keys.pictureInPicture.feedback===V.showNotification;return null!==document.pictureInPictureElement?(n&&v("Exiting Picture-in-Picture mode",this.notifDurationMs()),er(document.exitPictureInPicture())):(e.hasAttribute("disablepictureinpicture")&&e.removeAttribute("disablepictureinpicture"),n&&v("Entering Picture-in-Picture mode",this.notifDurationMs()),er(e.requestPictureInPicture())),m(t),!0}return!1}handledFasterOrSlower(e,t){return D.matchesEvent(this.prefs,this.prefs.keys.speedSlower,t)?(e.playbackRate=Math.max(.05,e.playbackRate-this.prefs.generalNumberOptions.speedChangeAmount.amount/100),this.prefs.keys.speedSlower.feedback===V.showNotification&&v("Playback rate:"+j(e.playbackRate),this.notifDurationMs()),m(t),!0):!!D.matchesEvent(this.prefs,this.prefs.keys.speedFaster,t)&&(e.playbackRate=Math.min(10,e.playbackRate+this.prefs.generalNumberOptions.speedChangeAmount.amount/100),this.prefs.keys.speedFaster.feedback===V.showNotification&&v("Playback rate:"+j(e.playbackRate),this.notifDurationMs()),m(t),!0)}handledBookmarkRestoreUndo(e,t,n){const s=()=>this.showNotificationWithEmojiSwitch("❌","No saved position found");if(D.matchesEvent(this.prefs,this.prefs.backupRestore.bookmarkBackup,n)){const s=e.currentTime;!function(e,t,n,s){const r={videoTimeSec:n,savedAt:Date.now()};se.X.add(e,t,r,s)}(this.prefs,t,s,(()=>{this.prefs.backupRestore.bookmarkBackup.feedback===V.showNotification&&this.showNotificationWithEmojiSwitch("💾","Saved position: "+N(s)),m(n)}))}else if(D.matchesEvent(this.prefs,this.prefs.backupRestore.bookmarkDelete,n))oe(t,(e=>{this.prefs.backupRestore.bookmarkDelete.feedback===V.showNotification&&(e?this.showNotificationWithEmojiSwitch("🔥","Removed saved position"):s()),m(n)}));else if(D.matchesEvent(this.prefs,this.prefs.backupRestore.bookmarkRestore,n)){const r=this.prefs.backupRestore.bookmarkRestore.feedback===V.showNotification;!function(e,t,n){se.X.load((s=>{const r=s.savedPoints[t];r?(e.currentTime=r.videoTimeSec,n(!0)):n(!1)}))}(e,t,(e=>{const o=()=>{r&&(e?this.showNotificationWithEmojiSwitch("↩️","Restoring saved position"):s())};e&&this.prefs.backupRestore.deleteOnRestore?oe(t,(e=>{o()})):o(),e&&m(n)}))}else{if(!D.matchesEvent(this.prefs,this.prefs.backupRestore.undoJump,n))return Qs;{const t=this.timeJumpMonitor.getVideoTimeBeforeLastJump();null!==t&&(this.prefs.backupRestore.undoJump.feedback===V.showNotification&&v("Jumping back",this.notifDurationMs()),e.currentTime=t)}}return Zs}handledSmallTimeJumps(e,t,n){const s=e.manualTimeSkips.oneValue,r=e.manualTimeSkips.twoValue,o=[{timeSkipDef:e.manualTimeSkips.oneMinus,delta:-1*s},{timeSkipDef:e.manualTimeSkips.onePlus,delta:1*s},{timeSkipDef:e.manualTimeSkips.twoMinus,delta:-1*r},{timeSkipDef:e.manualTimeSkips.twoPlus,delta:1*r}];for(const{timeSkipDef:s,delta:r}of o)if(D.matchesEvent(e,s,n))return ie(t,r),s.showProgressBar&&this.progressBarVisibilityController.showProgressBar(t),Zs;return Qs}handledLikeDislike(e,t){const n=function(){if(T()){const e="div#actions ytd-toggle-button-renderer#like-",t="div#actions ytd-toggle-button-renderer#dislike-",n="#like-button button",s="#dislike-button button";return{like:I(`${e}button`,n)||I(`${e}toggle-button`,n),dislike:I(`${t}button`,s)||I(`${t}toggle-button`,s)}}if(!E())return{like:null,dislike:null};const e=O("ytd-watch-metadata like-button-view-model button"),t=O("ytd-watch-metadata dislike-button-view-model button");if(e&&t)return{like:e,dislike:t};const n=O("like-button-view-model button"),s=O("dislike-button-view-model button");if(n&&s)return{like:n,dislike:s};const r=O("div#segmented-like-button button"),o=O("div#segmented-dislike-button button");if(r&&o)return{like:r,dislike:o};const i=document.getElementsByTagName("ytd-watch-metadata");let a=null,l=null;if(1===i.length){const e=Array.from(i[0].getElementsByTagName("button")),t=Array.from(i[0].getElementsByTagName("tp-yt-paper-button")),n=e.concat(t);for(const e of n)if(e.hasAttribute("aria-label")){const t=t=>-1!==e.getAttribute("aria-label")?.toLowerCase().indexOf(t);!l&&t("dislike")?l=e:a||t("dislike")||!t("like")||(a=e),!l&&t("disabled")&&(l=e)}!a&&e.length>4&&(a=e[4]),!l&&e.length>5&&(l=e[5])}return{like:a,dislike:l}}();if(D.matchesEvent(e,e.keys.likeVideo,t)&&n.like){const s=A(n.like),r=e.keys.likeVideo.feedback===V.showNotification;return r&&"true"===s?this.showNotificationWithEmojiSwitch("😭","Removed like from video"):r&&"false"===s&&this.showNotificationWithEmojiSwitch("❤️","Liked video"),n.like.click(),m(t),!0}if(D.matchesEvent(e,e.keys.dislikeVideo,t)&&n.dislike){const s=A(n.dislike),r=e.keys.dislikeVideo.feedback===V.showNotification;return r&&"true"===s?this.showNotificationWithEmojiSwitch("😐","Removed dislike from video"):r&&"false"===s&&(this.showNotificationWithEmojiSwitch("💔","Disliked video"),x(Date.now())),n.dislike.click(),m(t),!0}return!1}async handledChannelInfo(e,t){return D.matchesEvent(this.prefs,this.prefs.keys.channelInfo,t)?this.openChannelInfoModal(e):Qs}async buttonOpenChannelInfoModal(){if(this.prefs.logger.debug(`[content] buttonOpenChannelInfoModal, channelInfoModalVisible=${this.channelInfoModalVisible}`),this.channelInfoModalVisible)return!1;const e=P();return this.openChannelInfoModal(e)}async openChannelInfoModal(e){const t=T();if(!je.modalButtonExists(this.extensionInstanceId)&&!t)return this.prefs.logger.debug("Channel info modal button not found, not opening modal"),!1;if(this.channelInfoModalVisible)return await this.hideChannelInfoModal(),this.wasPlayingBeforeModal&&e&&er(e.play()),Zs;const n=E()?C(this.prefs.logger):t?function(e){const t=[],n=["div#channel-container ytd-channel-name#channel-name yt-formatted-string.ytd-channel-name a","div#overlay div#metapanel a[href]"];for(const e of n)t.push(...Array.from(document.querySelectorAll(e)).map((e=>e)).filter((e=>M(e))).filter((e=>(e.getAttribute("href")||"").startsWith("/@"))));return e.debug("Shorts viewer (nickname), anchors:",t),0===t.length?null:k(t[0].getAttribute("href")||"")}(this.prefs.logger):null,r=null!==n&&n.startsWith("@");if(this.wasPlayingBeforeModal=null!==e&&!e.paused&&this.prefs.generalBoolOptions.pauseResumeOnChannelModal.enabled,n){this.channelInfoModalVisible=!0,Wt.getState().setChannelModalActive(!0);const t={value:null};await this.jsxManager.render((0,s.jsx)(jt,{prefs:this.prefs,channelMetadataHolder:t,onChannelInfoClose:()=>{this.channelInfoModalVisible=!1,Wt.getState().setChannelModalActive(!1),this.wasPlayingBeforeModal&&e&&er(e.play())}})),this.wasPlayingBeforeModal&&e&&e.pause();const o=S(),i=await this.fetchChannelMetadata(n,r,o);t.value=i}else this.prefs.logger.debug("Could not find channel ID");return Zs}async fetchChannelMetadata(e,t,n){const s=xe.getInstance(),r=s.getChannelMetadata(e);let o;const i=new ke(this.prefs);if(r){o=r;const e=i.extractSubscribeButtonAndState();o.subscription=e.subscription,o.subscribeButton=e.button}else{this.prefs.keys.channelInfo.feedback===V.showNotification&&this.showNotificationWithEmojiSwitch("🔍","Fetching channel info");const r=t?`https://www.youtube.com/${e}`:`https://www.youtube.com/channel/${e}`;o=await i.fetchChannelMetadataContinued(r,n),s.setChannelMetadata(e,o)}return o}async hideChannelInfoModal(){this.channelInfoModalVisible&&await this.jsxManager.render((0,s.jsx)(s.Fragment,{})),this.channelInfoModalVisible=!1,Wt.getState().setChannelModalActive(!1)}async handledShortsViewerKeyboardEvent(e,t,n){const s=function(e,t){return D.matchesEvent(e,e.keys.shortsSwitchToRegular,t)?ne.OPEN_IN_SAME_TAB:D.matchesEvent(e,e.keys.shortsSwitchToRegularNewWindow,t)?ne.OPEN_IN_NEW_TAB:ne.NO_MATCH}(this.prefs,n);if(s===ne.OPEN_IN_SAME_TAB)return this.prefs.keys.shortsSwitchToRegular.feedback===V.showNotification&&this.showNotificationWithEmojiSwitch("🎦","Switching to classic player"),te(this.prefs,e,t,!1),m(n),!0;if(s===ne.OPEN_IN_NEW_TAB)return this.prefs.keys.shortsSwitchToRegularNewWindow.feedback===V.showNotification&&this.showNotificationWithEmojiSwitch("🎦","Opening new classic player"),te(this.prefs,e,t,!0),m(n),!0;if(D.matchesEvent(this.prefs,this.prefs.keys.shortsOpenComments,n)){const e=Array.from(document.querySelectorAll("ytd-engagement-panel-section-list-renderer")).filter((e=>M(e))).filter((e=>e.hasAttribute("visibility"))).find((e=>!0))||null;return null===e||e?.getAttribute("visibility")?.includes("HIDDEN")?(this.prefs.keys.shortsOpenComments.feedback===V.showNotification&&this.showNotificationWithEmojiSwitch("💬","Opening comments"),await this.hideChannelInfoModal(),function(){const e=I("div#comments-button ytd-button-renderer","yt-button-shape button");e&&e.click()}()):function(){const e=I("div#visibility-button ytd-button-renderer","yt-button-shape button");e&&e.click()}(),m(n),!0}{let e=!0;if(function(e,t){const n=r.Shortcuts.fromKeyDownEvent(t,r.CapsLock.Remove),s=[...Array(10).keys()].map((e=>r.Shortcuts.simple(e.toString()))).some((e=>r.Shortcuts.equals(e,n)));return s&&(H(e,n,t),z(t)),s}(this.prefs,n)&&this.prefs.generalBoolOptions.shortsEnableZeroToNine.enabled){const e=parseInt(n.key,10)/10;t.currentTime=e*t.duration,this.prefs.generalBoolOptions.shortsEnableZeroToNine.feedback===V.showNotification&&v("Jumped to "+100*e+"%",this.notifDurationMs())}else D.matchesEvent(this.prefs,U(r.Shortcuts.keyAndCode(",","Comma")),n)&&this.prefs.generalBoolOptions.shortsPreviousFrame.enabled?(ie(t,-1/30),this.prefs.generalBoolOptions.shortsPreviousFrame.feedback===V.showNotification&&v("Previous frame",this.notifDurationMs())):D.matchesEvent(this.prefs,U(r.Shortcuts.keyAndCode(".","Period")),n)&&this.prefs.generalBoolOptions.shortsNextFrame.enabled?(ie(t,1/30),this.prefs.generalBoolOptions.shortsNextFrame.feedback===V.showNotification&&v("Next frame",this.notifDurationMs())):D.matchesEvent(this.prefs,U(r.Shortcuts.simple("j")),n)&&this.prefs.generalBoolOptions.shortsMinusTenSec.enabled?(ie(t,-10),this.prefs.generalBoolOptions.shortsMinusTenSec.feedback===V.showNotification&&v("-10 seconds",this.notifDurationMs())):D.matchesEvent(this.prefs,U(r.Shortcuts.simple("l")),n)&&this.prefs.generalBoolOptions.shortsPlusTenSec.enabled?(ie(t,10),this.prefs.generalBoolOptions.shortsPlusTenSec.feedback===V.showNotification&&v("+10 seconds",this.notifDurationMs())):D.matchesEvent(this.prefs,this.prefs.keys.shortsFullscreen,n)?this.switchShortInOutOfFullScreen(t):D.matchesEvent(this.prefs,U(r.Shortcuts.shifted(r.Shortcuts.simple("n"))),n)&&this.prefs.generalBoolOptions.shortsNextVideo.enabled?(!function(){const e=document.querySelector("div.navigation-button#navigation-button-down button");e&&e.click()}(),this.prefs.generalBoolOptions.shortsNextVideo.feedback===V.showNotification&&this.showNotificationWithEmojiSwitch("⬇️️","Next short")):D.matchesEvent(this.prefs,U(r.Shortcuts.shifted(r.Shortcuts.simple("p"))),n)&&this.prefs.generalBoolOptions.shortsPreviousVideo.enabled?(!function(){const e=document.querySelector("div.navigation-button#navigation-button-up button");e&&e.click()}(),this.prefs.generalBoolOptions.shortsPreviousVideo.feedback===V.showNotification&&this.showNotificationWithEmojiSwitch("⬆️","Previous short")):e=!1;if(e)return m(n),!0}return!1}switchShortInOutOfFullScreen(e){document.fullscreenElement===e?er(document.exitFullscreen()):(this.prefs.keys.shortsFullscreen.feedback===V.showNotification&&v("Fullscreen mode",this.notifDurationMs()),er(e.requestFullscreen()))}}(ee.create());ee.load((e=>{tr.updatePrefs(e),tr.installListenersAtStartup(),tr.monitorKeyPressAndReloadEvents(),tr.processInitialCssRemovals(),tr.runTasksOnceLoaded()}))}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={id:e,loaded:!1,exports:{}};return s[e].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=s,e=[],o.O=(t,n,s,r)=>{if(!n){var i=1/0;for(h=0;h<e.length;h++){for(var[n,s,r]=e[h],a=!0,l=0;l<n.length;l++)(!1&r||i>=r)&&Object.keys(o.O).every((e=>o.O[e](n[l])))?n.splice(l--,1):(a=!1,r<i&&(i=r));if(a){e.splice(h--,1);var c=s();void 0!==c&&(t=c)}}return t}r=r||0;for(var h=e.length;h>0&&e[h-1][2]>r;h--)e[h]=e[h-1];e[h]=[n,s,r]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(e,s){if(1&s&&(e=this(e)),8&s)return e;if("object"==typeof e&&e){if(4&s&&e.__esModule)return e;if(16&s&&"function"==typeof e.then)return e}var r=Object.create(null);o.r(r);var i={};t=t||[null,n({}),n([]),n(n)];for(var a=2&s&&e;"object"==typeof a&&!~t.indexOf(a);a=n(a))Object.getOwnPropertyNames(a).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,o.d(r,i),r},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.j=230,(()=>{var e={230:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var s,r,[i,a,l]=n,c=0;if(i.some((t=>0!==e[t]))){for(s in a)o.o(a,s)&&(o.m[s]=a[s]);if(l)var h=l(o)}for(t&&t(n);c<i.length;c++)r=i[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(h)},n=self.webpackChunkyoutube_extra_shortcuts=self.webpackChunkyoutube_extra_shortcuts||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),o.nc=void 0;var i=o.O(void 0,[121],(()=>o(7745)));i=o.O(i)})();